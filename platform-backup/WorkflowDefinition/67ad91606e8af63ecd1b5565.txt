{
	"appsUsed":[
		
	],
	"createdTime":1740748546088,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1755437767286,
		"deployedBy":-1,
		"deployedDefinitionId":"68a1dac79d7d8d3f50462406",
		"status":"DEPLOYED",
		"version":3,
		"workflowVersion":66
	},
	"edges":[
		{
			"fromNodeId":"R0lx9",
			"priority":0,
			"skip":false,
			"toNodeId":"8gv04",
			"type":"next"
		},
		{
			"fromNodeId":"8gv04",
			"priority":0,
			"skip":false,
			"toNodeId":"z9SOq",
			"type":"next"
		},
		{
			"fromNodeId":"z9SOq",
			"priority":0,
			"skip":false,
			"toNodeId":"XM27e",
			"type":"next"
		},
		{
			"fromNodeId":"XM27e",
			"priority":0,
			"skip":false,
			"toNodeId":"Fwy5B",
			"type":"next"
		},
		{
			"fromNodeId":"Fwy5B",
			"priority":0,
			"skip":false,
			"toNodeId":"91H0p",
			"type":"next"
		},
		{
			"fromNodeId":"91H0p",
			"priority":0,
			"skip":false,
			"toNodeId":"Gxp56",
			"type":"next"
		},
		{
			"fromNodeId":"Gxp56",
			"priority":0,
			"skip":false,
			"toNodeId":"Toq5K",
			"type":"next"
		},
		{
			"fromNodeId":"Toq5K",
			"priority":0,
			"skip":false,
			"toNodeId":"MZifc",
			"type":"next"
		},
		{
			"fromNodeId":"MZifc",
			"priority":0,
			"skip":false,
			"toNodeId":"quOEa",
			"type":"next"
		},
		{
			"fromNodeId":"quOEa",
			"name":"error",
			"priority":0,
			"skip":false,
			"toNodeId":"dUlTz",
			"type":"error"
		},
		{
			"fromNodeId":"quOEa",
			"priority":0,
			"skip":false,
			"toNodeId":"n_MvJXK",
			"type":"next"
		},
		{
			"fromNodeId":"dUlTz",
			"priority":0,
			"skip":false,
			"toNodeId":"n_MvJXK",
			"type":"next"
		},
		{
			"fromNodeId":"n_MvJXK",
			"priority":0,
			"skip":false,
			"toNodeId":"LsD3O",
			"type":"next"
		},
		{
			"fromNodeId":"LsD3O",
			"priority":0,
			"skip":false,
			"toNodeId":"baHza",
			"type":"next"
		},
		{
			"fromNodeId":"baHza",
			"priority":0,
			"skip":false,
			"toNodeId":"zAFUN",
			"type":"next"
		},
		{
			"fromNodeId":"zAFUN",
			"priority":0,
			"skip":false,
			"toNodeId":"8oHAS",
			"type":"next"
		},
		{
			"fromNodeId":"8oHAS",
			"priority":0,
			"skip":false,
			"toNodeId":"s5q9l",
			"type":"next"
		},
		{
			"fromNodeId":"s5q9l",
			"priority":0,
			"skip":false,
			"toNodeId":"e1QLm",
			"type":"next"
		},
		{
			"fromNodeId":"e1QLm",
			"priority":0,
			"skip":false,
			"toNodeId":"5Hdyk",
			"type":"loop"
		},
		{
			"fromNodeId":"5Hdyk",
			"name":"error",
			"priority":0,
			"skip":false,
			"toNodeId":"sZ0HL",
			"type":"error"
		},
		{
			"fromNodeId":"5Hdyk",
			"priority":0,
			"skip":false,
			"toNodeId":"_CXup0",
			"type":"next"
		},
		{
			"fromNodeId":"sZ0HL",
			"priority":0,
			"skip":false,
			"toNodeId":"_CXup0",
			"type":"next"
		},
		{
			"fromNodeId":"_CXup0",
			"priority":0,
			"skip":false,
			"toNodeId":"Y4Afv",
			"type":"next"
		},
		{
			"fromNodeId":"Y4Afv",
			"priority":0,
			"skip":false,
			"toNodeId":"rHrG9",
			"type":"next"
		},
		{
			"fromNodeId":"rHrG9",
			"priority":0,
			"skip":false,
			"toNodeId":"Lq5n1",
			"type":"next"
		},
		{
			"fromNodeId":"Lq5n1",
			"priority":0,
			"skip":false,
			"toNodeId":"ZV6Z9",
			"type":"next"
		},
		{
			"fromNodeId":"ZV6Z9",
			"priority":0,
			"skip":false,
			"toNodeId":"TwYt3",
			"type":"next"
		},
		{
			"fromNodeId":"TwYt3",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"Ddhwy",
			"type":"if"
		},
		{
			"fromNodeId":"Ddhwy",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"e1QLm",
			"type":"next"
		},
		{
			"fromNodeId":"TwYt3",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"e1QLm",
			"type":"next"
		},
		{
			"fromNodeId":"e1QLm",
			"priority":0,
			"skip":false,
			"toNodeId":"VTO0z",
			"type":"next"
		},
		{
			"fromNodeId":"VTO0z",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"SSxhN",
			"type":"if"
		},
		{
			"fromNodeId":"SSxhN",
			"priority":0,
			"skip":false,
			"toNodeId":"8XKoa",
			"type":"next"
		},
		{
			"fromNodeId":"VTO0z",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"8XKoa",
			"type":"next"
		},
		{
			"fromNodeId":"8XKoa",
			"name":"error",
			"priority":0,
			"skip":false,
			"toNodeId":"kqju6",
			"type":"error"
		},
		{
			"fromNodeId":"8XKoa",
			"priority":0,
			"skip":false,
			"toNodeId":"fpxuE",
			"type":"next"
		},
		{
			"fromNodeId":"kqju6",
			"priority":0,
			"skip":false,
			"toNodeId":"fpxuE",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"67ad91606e8af63ecd1b5565",
	"lastModifiedBy":-1,
	"lcName":"agentic chunking pdf - rag | extract chunks from a page",
	"modifiedTime":1758530870691,
	"name":"Agentic Chunking PDF - RAG | Extract Chunks from a Page",
	"nodes":[
		{
			"additional":{
				"xsdSchemaConfig":{
					"root.result":{}
				}
			},
			"context":{
				"appName":"callables",
				"resourceVersion":271,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"R0lx9",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"chunks":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"text":{
										"type":"string",
										"title":"text"
									},
									"metadata":{
										"type":"object",
										"properties":{
											"chunkUUID":{
												"type":"string",
												"title":"chunkUUID"
											},
											"chunkType":{
												"type":"string",
												"title":"chunkType"
											},
											"chunkIndexedType":{
												"type":"string",
												"title":"chunkIndexedType"
											},
											"contentForGeneration":{
												"type":"string",
												"title":"contentForGeneration"
											},
											"pageNumber":{
												"type":"integer",
												"title":"pageNumber"
											},
											"rawText":{
												"type":"string",
												"title":"Raw Text"
											}
										},
										"title":"metadata",
										"additionalProperties":false,
										"required":[]
									}
								},
								"additionalProperties":false
							},
							"title":"chunks"
						}
					},
					"additionalProperties":false
				},
				"setup":{
					"type":"object",
					"properties":{
						"file":{
							"type":"object",
							"properties":{
								"source":{
									"type":"string",
									"title":"source"
								},
								"sourceType":{
									"type":"string",
									"title":"sourceType"
								},
								"type":{
									"type":"string",
									"title":"type"
								},
								"name":{
									"type":"string",
									"title":"name"
								}
							},
							"title":"file",
							"additionalProperties":false
						},
						"pageNumber":{
							"type":"integer",
							"title":"pageNumber"
						},
						"text":{
							"type":"string",
							"title":"text"
						},
						"mimeType":{
							"type":"string",
							"title":"mimeType"
						},
						"documentTopic":{
							"type":"string",
							"title":"documentTopic"
						},
						"document_parsing_model":{
							"type":"string",
							"title":"document_parsing_model"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"template_by_unifyapps",
				"resourceVersion":285,
				"resourceName":"template_by_unifyapps_compile_template",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"8gv04",
			"index":2,
			"inputs":{
				"input_schema":{
					"page_text":"{{ R0lx9.outputs.text }}",
					"document_topic":"{{ R0lx9.outputs.documentTopic }}"
				},
				"template_id":"e_67ac67bfbadcb4294dc03740"
			},
			"skip":false,
			"subTitle":"Template by UnifyApps",
			"title":"Compile template",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":328,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"z9SOq",
			"index":3,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"type":"object",
									"properties":{
										"content":{
											"type":"array",
											"items":{
												"type":"object",
												"properties":{
													"type":{
														"type":"string",
														"title":"type"
													},
													"text":{
														"type":"string",
														"title":"text"
													},
													"source":{
														"type":"object",
														"properties":{
															"image_type":{
																"type":"string",
																"title":"image_type"
															},
															"media_type":{
																"type":"object",
																"properties":{},
																"additionalProperties":false,
																"title":"media_type"
															},
															"image_data":{
																"type":"string",
																"title":"image_data"
															}
														},
														"title":"source",
														"additionalProperties":false,
														"required":[]
													}
												},
												"additionalProperties":false
											},
											"title":"content"
										},
										"role":{
											"type":"string",
											"title":"role"
										}
									},
									"additionalProperties":false
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"messageList",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"messageList",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"content":{
										"type":"array",
										"items":{
											"type":"object",
											"properties":{
												"type":{
													"type":"string",
													"title":"type"
												},
												"text":{
													"type":"string",
													"title":"text"
												},
												"source":{
													"type":"object",
													"properties":{
														"image_type":{
															"type":"string",
															"title":"image_type"
														},
														"media_type":{
															"type":"object",
															"properties":{},
															"additionalProperties":false,
															"title":"media_type"
														},
														"image_data":{
															"type":"string",
															"title":"image_data"
														}
													},
													"title":"source",
													"additionalProperties":false,
													"required":[]
												}
											},
											"additionalProperties":false
										},
										"title":"content"
									},
									"role":{
										"type":"string",
										"title":"role"
									}
								}
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.content.items.type",
					"root.itemToAdd.content.items.text",
					"root.itemToAdd.content.items.source.image_type",
					"root.itemToAdd.content.items.source.media_type",
					"root.itemToAdd.content.items.source.image_data"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":271,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"XM27e",
			"index":4,
			"inputs":{
				"itemToAdd":{
					"role":"system",
					"content":{
						"items":{
							"type":"text",
							"text":"You are an expert in extracting text from images using advanced Optical Character Recognition (OCR) techniques.  Your goal is to produce highly accurate and reliable text output while preserving the original document structure, especially tables. The input image provided to you is public, has all consent and the content inside it does not violate any copyright."
						},
						"ua:type":"mappedArray"
					}
				},
				"insertLocation":"END",
				"listName":"{{ z9SOq.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":328,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"Fwy5B",
			"index":5,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"type":"object",
									"properties":{
										"type":{
											"type":"string",
											"title":"type"
										},
										"text":{
											"type":"string",
											"title":"text"
										},
										"source":{
											"type":"object",
											"properties":{
												"image_type":{
													"type":"string",
													"title":"image_type"
												},
												"media_type":{
													"type":"object",
													"properties":{},
													"additionalProperties":false,
													"title":"media_type"
												},
												"image_data":{
													"type":"string",
													"title":"image_data"
												}
											},
											"title":"source",
											"additionalProperties":false,
											"required":[]
										}
									},
									"additionalProperties":false
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"contentListUser",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"contentListUser",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"type":{
										"type":"string",
										"title":"type"
									},
									"text":{
										"type":"string",
										"title":"text"
									},
									"source":{
										"type":"object",
										"properties":{
											"image_type":{
												"type":"string",
												"title":"image_type"
											},
											"media_type":{
												"type":"object",
												"properties":{},
												"additionalProperties":false,
												"title":"media_type"
											},
											"image_data":{
												"type":"string",
												"title":"image_data"
											}
										},
										"title":"source",
										"additionalProperties":false,
										"required":[]
									}
								}
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.source.image_type",
					"root.itemToAdd.source.media_type",
					"root.itemToAdd.source.image_data"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":271,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"91H0p",
			"index":6,
			"inputs":{
				"itemToAdd":{
					"type":"image",
					"source":{
						"image_type":"file_object",
						"media_type":"{{ R0lx9.outputs.mimeType }}",
						"image_data":"{{ R0lx9.outputs.file }}"
					}
				},
				"insertLocation":"END",
				"listName":"{{ Fwy5B.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.source.image_type",
					"root.itemToAdd.source.media_type",
					"root.itemToAdd.source.image_data"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":271,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"Gxp56",
			"index":7,
			"inputs":{
				"itemToAdd":{
					"type":"text",
					"text":"{{ 8gv04.outputs.output }}"
				},
				"insertLocation":"END",
				"listName":"{{ Fwy5B.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.content.items.type",
					"root.itemToAdd.content.items.text",
					"root.itemToAdd.content.items.source.image_type",
					"root.itemToAdd.content.items.source.media_type",
					"root.itemToAdd.content.items.source.image_data"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":271,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"Toq5K",
			"index":8,
			"inputs":{
				"itemToAdd":{
					"content":{
						"source":"{{ Fwy5B.outputs.items }}",
						"ua:type":"mappedArray",
						"items":{
							"type":"{{ Fwy5B.outputs.items[0].type }}",
							"text":"{{ Fwy5B.outputs.items[0].text }}",
							"source":{
								"image_type":"{{ Fwy5B.outputs.items[0].source.image_type }}",
								"media_type":"{{ Fwy5B.outputs.items[0].source.media_type }}",
								"image_data":"{{ Fwy5B.outputs.items[0].source.image_data }}"
							}
						}
					},
					"role":"user"
				},
				"insertLocation":"END",
				"listName":"{{ z9SOq.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":73,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"MZifc",
			"index":9,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"finish_reason":{
							"type":"string",
							"title":"finish_reason"
						},
						"final_text_response":{
							"type":"string",
							"title":"final_text_response"
						}
					},
					"required":[]
				}
			},
			"inputs":{},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"finish_reason":{
							"type":"string",
							"title":"finish_reason"
						},
						"final_text_response":{
							"type":"string",
							"title":"final_text_response"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":282,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"MANUAL",
			"groupId":"fAeOt-1",
			"id":"quOEa",
			"index":10,
			"inputs":{
				"automationId":"66ac70650f725f5b425d12d8",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"logProbs":false,
					"temperature":0,
					"responseFormat":{
						"type":"text"
					},
					"maxTokens":8192,
					"message":{
						"source":"{{ z9SOq.outputs.items }}",
						"ua:type":"mappedArray",
						"items":{
							"role":"{{ z9SOq.outputs.items[0].role }}",
							"content":{
								"source":"{{ z9SOq.outputs.items[0].content }}",
								"ua:type":"mappedArray",
								"items":"{{ z9SOq.outputs.items[0].content[0] }}"
							}
						}
					},
					"modelId":"{{ R0lx9.outputs.document_parsing_model }}",
					"top_p":1,
					"topK":1
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":2.0,
					"captureRetries":false,
					"count":3,
					"enabled":true,
					"initialDelay":1000,
					"maxDelay":2000
				},
				"stepError":"MANUAL",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":262,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"quOEa@fAeOt-1@error",
			"id":"dUlTz",
			"index":11,
			"inputs":{
				"result":{
					"chunks":{
						"items":{
							"text":"{{ R0lx9.outputs.text }}",
							"metadata":{
								"pageNumber":"{{ R0lx9.outputs.pageNumber }}"
							}
						},
						"ua:type":"mappedArray"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":451,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"n_MvJXK",
			"index":12,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"sanitized_llm_response":{
							"type":"string",
							"title":"Sanitized Llm Response"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"llm_response":{
							"type":"string",
							"title":"Llm Response"
						}
					}
				},
				"code":"import java.util.regex.Pattern\n\ndef sanitized_llm_response = \"\"\n\ndef llm_response = binding.hasVariable('llm_response') ? binding.getVariable('llm_response') : null\n\nif (llm_response != null) {\n    sanitized_llm_response = llm_response.replaceAll(/\\s+/, ' ')\n}\n\ndef result = [sanitized_llm_response: sanitized_llm_response]",
				"compile_static":false,
				"parameters":{
					"llm_response":"{{ quOEa.outputs.llmResponse }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.content.items.type",
					"root.itemToAdd.content.items.text",
					"root.itemToAdd.content.items.source.image_type",
					"root.itemToAdd.content.items.source.media_type",
					"root.itemToAdd.content.items.source.image_data"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":73,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"LsD3O",
			"index":13,
			"inputs":{
				"itemToAdd":{
					"role":"assistant",
					"content":{
						"items":{
							"type":"text",
							"text":"{{ n_MvJXK.outputs.result.sanitized_llm_response }}"
						},
						"ua:type":"mappedArray"
					}
				},
				"insertLocation":"END",
				"listName":"{{ z9SOq.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":72,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"baHza",
			"index":14,
			"inputs":{
				"variables":[
					{
						"source":"{{ MZifc.outputs.finish_reason }}",
						"value":"{{ quOEa.outputs.finish_reason }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":8,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"zAFUN",
			"index":15,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"final_text_response":{
							"type":"string",
							"title":"final_text_response"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"final_text_response":{
							"type":"string",
							"title":"final_text_response"
						},
						"llm_response":{
							"type":"string",
							"title":"llm_response"
						}
					}
				},
				"code":"final_text = \"\"\nif (binding.hasVariable(\"final_text_response\")){\n  final_text += final_text_response \n}\nif (binding.hasVariable(\"llm_response\")){\n  final_text += llm_response\n}\n\nresult = [\"final_text_response\":final_text]",
				"compile_static":false,
				"parameters":{
					"final_text_response":"{{ MZifc.outputs.final_text_response }}",
					"llm_response":"{{ n_MvJXK.outputs.result.sanitized_llm_response }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":8,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"8oHAS",
			"index":16,
			"inputs":{
				"variables":[
					{
						"source":"{{ MZifc.outputs.final_text_response }}",
						"value":"{{ zAFUN.outputs.result.final_text_response }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":384,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"s5q9l",
			"index":17,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"currIdx":{
							"type":"integer",
							"title":"Curr Idx"
						},
						"maxSteps":{
							"type":"integer",
							"title":"Max Steps"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"currIdx":0,
				"maxSteps":3
			},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"currIdx":{
							"type":"integer",
							"title":"Curr Idx"
						},
						"maxSteps":{
							"type":"integer",
							"title":"Max Steps"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":73,
				"resourceName":"loop_while",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"e1QLm",
			"index":18,
			"inputs":{
				"condition":{
					"filters":[
						{
							"property":"=LOWER({{ MZifc.outputs.finish_reason }})",
							"filter":{
								"operator":"NOT_EQUAL",
								"value":"stop"
							}
						},
						{
							"property":"=LOWER({{ MZifc.outputs.finish_reason }})",
							"filter":{
								"operator":"NOT_EQUAL",
								"value":"end_turn"
							}
						},
						{
							"property":"{{ s5q9l.outputs.currIdx }}",
							"filter":{
								"operator":"LT",
								"value":"{{ s5q9l.outputs.maxSteps }}"
							}
						}
					],
					"operator":"AND"
				},
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"While loop",
			"type":"LOOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":282,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"MANUAL",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"5Hdyk",
			"index":19,
			"inputs":{
				"automationId":"66ac70650f725f5b425d12d8",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"logProbs":false,
					"temperature":0,
					"responseFormat":{
						"type":"text"
					},
					"maxTokens":8192,
					"message":{
						"source":"{{ z9SOq.outputs.items }}",
						"ua:type":"mappedArray",
						"items":{
							"role":"{{ z9SOq.outputs.items[0].role }}",
							"content":{
								"source":"{{ z9SOq.outputs.items[0].content }}",
								"ua:type":"mappedArray",
								"items":"{{ z9SOq.outputs.items[0].content[0] }}"
							}
						}
					},
					"modelId":"{{ R0lx9.outputs.document_parsing_model }}",
					"top_p":1,
					"topK":1
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":2.0,
					"captureRetries":false,
					"count":3,
					"enabled":true,
					"initialDelay":1000,
					"maxDelay":2000
				},
				"stepError":"MANUAL",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":262,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"5Hdyk@e1QLm@fAeOt-1@l@error",
			"id":"sZ0HL",
			"index":20,
			"inputs":{
				"result":{
					"chunks":{
						"items":{
							"text":"{{ R0lx9.outputs.text }}",
							"metadata":{
								"pageNumber":"{{ R0lx9.outputs.pageNumber }}"
							}
						},
						"ua:type":"mappedArray"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":451,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"_CXup0",
			"index":21,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"sanitized_llm_response":{
							"type":"string",
							"title":"Sanitized Llm Response"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"llm_response":{
							"type":"string",
							"title":"Llm Response"
						}
					}
				},
				"code":"import java.util.regex.Pattern\n\ndef sanitized_llm_response = \"\"\n\ndef llm_response = binding.hasVariable('llm_response') ? binding.getVariable('llm_response') : null\n\nif (llm_response != null) {\n    sanitized_llm_response = llm_response.replaceAll(/\\s+/, ' ')\n}\n\ndef result = [sanitized_llm_response: sanitized_llm_response]",
				"compile_static":false,
				"parameters":{
					"llm_response":"{{ 5Hdyk.outputs.llmResponse }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.content.items.type",
					"root.itemToAdd.content.items.text",
					"root.itemToAdd.content.items.source.image_type",
					"root.itemToAdd.content.items.source.media_type",
					"root.itemToAdd.content.items.source.image_data"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":73,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"Y4Afv",
			"index":22,
			"inputs":{
				"itemToAdd":{
					"role":"assistant",
					"content":{
						"items":{
							"type":"text",
							"text":"{{ _CXup0.outputs.result.sanitized_llm_response }}"
						},
						"ua:type":"mappedArray"
					}
				},
				"insertLocation":"END",
				"listName":"{{ z9SOq.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":72,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"rHrG9",
			"index":23,
			"inputs":{
				"variables":[
					{
						"source":"{{ MZifc.outputs.finish_reason }}",
						"value":"{{ 5Hdyk.outputs.finish_reason }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":8,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"Lq5n1",
			"index":24,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"final_text_response":{
							"type":"string",
							"title":"final_text_response"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"final_text_response":{
							"type":"string",
							"title":"final_text_response"
						},
						"llm_response":{
							"type":"string",
							"title":"llm_response"
						}
					}
				},
				"code":"final_text = \"\"\nif (binding.hasVariable(\"final_text_response\")){\n  final_text += final_text_response \n}\nif (binding.hasVariable(\"llm_response\")){\n  final_text += llm_response\n}\n\nresult = [\"final_text_response\":final_text]",
				"compile_static":false,
				"parameters":{
					"final_text_response":"{{ MZifc.outputs.final_text_response }}",
					"llm_response":"{{ _CXup0.outputs.result.sanitized_llm_response }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":8,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"ZV6Z9",
			"index":25,
			"inputs":{
				"variables":[
					{
						"source":"{{ MZifc.outputs.final_text_response }}",
						"value":"{{ Lq5n1.outputs.result.final_text_response }}"
					},
					{
						"source":"{{ s5q9l.outputs.currIdx }}",
						"value":"={{ s5q9l.outputs.currIdx }}+1"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":2,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"e1QLm@fAeOt-1@l",
			"id":"TwYt3",
			"index":26,
			"inputs":{
				"filters":[
					{
						"property":"{{ e1QLm.outputs.index }}",
						"filter":{
							"operator":"GT",
							"value":"3"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"break",
				"resourceVersion":2,
				"resourceName":"break",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"TwYt3@e1QLm@fAeOt-1@l@y",
			"id":"Ddhwy",
			"index":27,
			"inputs":{
				"loop":"e1QLm"
			},
			"skip":false,
			"subTitle":"Break",
			"title":"Break",
			"type":"BREAK"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":71,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"VTO0z",
			"index":28,
			"inputs":{
				"filters":[
					{
						"property":"=LOWER({{ MZifc.outputs.finish_reason }})",
						"filter":{
							"operator":"NOT_EQUAL",
							"value":"stop"
						}
					},
					{
						"property":"=LOWER({{ MZifc.outputs.finish_reason }})",
						"filter":{
							"operator":"NOT_EQUAL",
							"value":"end_turn"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":72,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"VTO0z@fAeOt-1@y",
			"id":"SSxhN",
			"index":29,
			"inputs":{
				"object_type":"test_agentic_chunking_stop",
				"record":{
					"name":"{{ R0lx9.outputs.file.name }}",
					"source":"{{ R0lx9.outputs.file.source }}",
					"sourceType":"{{ R0lx9.outputs.file.sourceType }}",
					"type":"{{ R0lx9.outputs.file.type }}",
					"mimeType":"{{ R0lx9.outputs.mimeType }}",
					"pageNumber":"{{ R0lx9.outputs.pageNumber }}",
					"finishReason":"{{ quOEa.outputs.finish_reason }}",
					"llmOutput":"{{ quOEa.outputs.llmResponse }}"
				}
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{},
				"visibleOptionalFields":[
					"root.parameters.inputs.dummy",
					"root.parameters.inputs.documentTopic",
					"root.parameters.inputs.text"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":155,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"MANUAL",
			"groupId":"fAeOt-1",
			"id":"8XKoa",
			"index":30,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"chunks":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"text":{
										"type":"string",
										"title":"text"
									},
									"metadata":{
										"type":"object",
										"properties":{
											"chunkUUID":{
												"type":"string",
												"title":"chunkUUID"
											},
											"chunkType":{
												"type":"string",
												"title":"chunkType"
											},
											"chunkIndexedType":{
												"type":"string",
												"title":"chunkIndexedType"
											},
											"contentForGeneration":{
												"type":"string",
												"title":"contentForGeneration"
											},
											"rawText":{
												"type":"string",
												"title":"Raw Text"
											}
										},
										"title":"metadata",
										"additionalProperties":false,
										"required":[]
									}
								},
								"additionalProperties":false
							},
							"title":"chunks"
						}
					},
					"additionalProperties":false
				},
				"input":{
					"type":"object",
					"properties":{
						"inputs":{
							"type":"object",
							"properties":{
								"dummy":{
									"type":"string",
									"title":"dummy"
								},
								"documentTopic":{
									"type":"string",
									"title":"documentTopic"
								},
								"text":{
									"type":"string",
									"title":"text"
								}
							},
							"title":"inputs",
							"additionalProperties":false
						}
					},
					"additionalProperties":false
				},
				"compile_static":false,
				"code":"import java.util.UUID\nimport java.util.regex.Pattern\nimport java.util.regex.Matcher\n\ndef extractChunks(String text) {\n    // Pattern to capture <chunk type=\"...\">...</chunk>\n    def pattern = /(?s)<chunk\\s+type\\s*=\\s*\"(.*?)\">(.*?)<\\/chunk>/\n\n    try {\n        // Find all well-formed chunks (type and content)\n        def matcher = text =~ pattern\n        def matches = []\n        \n        while (matcher.find()) {\n            matches << [matcher.group(1), matcher.group(2)]\n        }\n\n        // If no matches found, fallback to single chunk with entire text\n        if (matches.isEmpty()) {\n            return [\n                chunks: [\n                    [\n                        type: \"text\",\n                        text: text.trim(),\n                        questions: [],\n                        description: \"\",\n                        context: \"\",\n                    ]\n                ]\n            ]\n        }\n\n        def chunksList = []\n\n        for (match in matches) {\n            def chunkType = match[0]\n            def chunkContent = match[1]\n            \n            def contextMatcher = chunkContent =~ /(?s)<context>(.*?)<\\/context>/\n            def context = \"\"\n            def chunkContentCleaned = chunkContent\n            \n            if (contextMatcher.find()) {\n                context = contextMatcher.group(1).trim()\n                chunkContentCleaned = chunkContentCleaned.replaceAll(/(?s)<context>.*?<\\/context>/, '')\n            }\n\n            // Search for <description>...</description>\n            def descMatcher = chunkContentCleaned =~ /(?s)<description>(.*?)<\\/description>/\n            def description = \"\"\n            \n            if (descMatcher.find()) {\n                description = descMatcher.group(1).trim()\n                // Remove the description section from the chunk content\n                chunkContentCleaned = chunkContentCleaned.replaceAll(/(?s)<description>.*?<\\/description>/, '')\n            }\n\n            // Find all <question> blocks\n            def questionMatcher = chunkContentCleaned =~ /(?s)<question>(.*?)<\\/question>/\n            def questions = []\n            \n            while (questionMatcher.find()) {\n                questions << questionMatcher.group(1)\n            }\n            \n            // Remove the <question> blocks\n            chunkContentCleaned = chunkContentCleaned.replaceAll(/(?s)<question>.*?<\\/question>/, '').trim()\n\n            // Normalize type for consistency\n            def lowerType = chunkType.toLowerCase()\n\n            // Build chunk dict depending on known types: \"text\", \"table\", \"image\", etc.\n            def chunkDict\n            \n            if (lowerType in [\"table\", \"image\"]) {\n                chunkDict = [\n                    type: lowerType,\n                    context: context,\n                    description: description,\n                    text: chunkContentCleaned,\n                    questions: questions,\n                ]\n            } else if (lowerType == \"text\") {\n                chunkDict = [\n                    type: \"text\",\n                    text: chunkContentCleaned,\n                    context: context,\n                    questions: questions,\n                    description: \"\",\n                ]\n            } else {\n                // For unrecognized types, treat similarly to text or handle as needed\n                chunkDict = [\n                    type: lowerType,\n                    text: chunkContentCleaned,\n                    context: context,\n                    questions: questions,\n                    description: \"\",\n                ]\n            }\n\n            chunksList << chunkDict\n        }\n\n        return [chunks: chunksList]\n\n    } catch (Exception e) {\n        // On any parse error or anomaly, return the entire text as one chunk\n        return [\n            chunks: [\n                [\n                    type: \"text\",\n                    text: text.trim(),\n                    questions: [],\n                    description: \"\",\n                    context: \"\",\n                ]\n            ]\n        ]\n    }\n}\n\ndef chunks = extractChunks(inputs.get(\"text\", \"\"))\ndef chunksList = chunks.chunks\ndef modifiedChunksList = []\ndef blacklistedPatternInQuestion = [\n    /\\bthis\\s+(image|page|financial|document|report|section|statement)\\b/,\n    /\\bthe\\s+(image|page|financial|document|report|section|statement)\\b/,\n    /\\bwhich\\s+(image|page|financial|document|report|section|statement)\\b/,\n    /\\bwhat\\s+is\\s+the\\s+name\\s+of\\s+the\\s+(company|report|statement)\\b/,\n    /\\bwhat\\s+type\\s+of\\s+(image|page|financial|document|report|section|statement)\\b/,\n    /\\bwhat\\s+(page|pages)\\b/,\n    /\\baccompanying\\s+notes\\s+from\\b/\n]\ndef documentTopic = inputs.get(\"documentTopic\", \"\")\n\nfor (chunk in chunksList) {\n    def randomUuid = UUID.randomUUID().toString()\n    def chunkType = (chunk.type ?: \"\").toLowerCase()\n    def context = chunk.context ?: \"\"\n    def description = chunk.description ?: \"\"\n    def text = chunk.text ?: \"\"\n    def rawText=chunk.text?:\"\"\n    def tokenText = text.split(\" \")\n    if (tokenText.length < 5 && !(chunkType in ['table', 'image'])) {\n        continue\n    }\n    def chunkIndexedType = \"text\"\n    def contentText = \"\"\n    if (documentTopic.trim()) {\n        contentText += \"Chunk Document Topic: ${documentTopic}\\n\"\n    }\n    if (context.trim()) {\n        contentText += \"Chunk Context: ${context}\\n\"\n    }\n    if (description.trim()) {\n        contentText += \"${chunkType.capitalize()} Description: ${description}\\n\"\n    }\n    if (text.trim()) {\n        contentText += \"Content: ${text}\"\n    }\n    \n    if (text.trim()) {\n        def embeddingText = context + \"\\n\" + text\n        modifiedChunksList << [\n            text: embeddingText,\n            metadata: [\n                chunkUUID: randomUuid,\n                chunkType: chunkType,\n                chunkIndexedType: chunkIndexedType,\n                contentForGeneration: contentText,\n                rawText:rawText\n            ]\n        ]\n    }\n    if (description.trim()) {\n        chunkIndexedType = \"description\"\n        def embeddingText = context + \"\\n\" + description\n        modifiedChunksList << [\n            text: embeddingText,\n            metadata: [\n                chunkUUID: randomUuid,\n                chunkType: chunkType,\n                chunkIndexedType: chunkIndexedType,\n                contentForGeneration: contentText,\n                rawText:rawText\n            ]\n        ]\n    }\n    def questions = chunk.questions ?: []\n    if (tokenText.length < 20 && !(chunkType in ['table', 'image'])) {\n        continue\n    }\n\n    for (question in questions) {\n        def questionLower = question.toLowerCase()\n        def flag = false\n        try {\n            for (pattern in blacklistedPatternInQuestion) {\n                if (questionLower =~ pattern) {\n                    flag = true\n                    break\n                }\n            }\n        } catch (Exception err) {\n            question = err.toString()\n        }\n\n        if (flag) {\n            continue\n        }\n\n        def contextualizedQuestion = context + \"\\n\" + question\n        modifiedChunksList << [\n            text: contextualizedQuestion,\n            metadata: [\n                chunkUUID: randomUuid,\n                chunkType: chunkType,\n                chunkIndexedType: \"question\",\n                contentForGeneration: contentText,\n                rawText:rawText\n            ]\n        ]\n    }\n}\n\nreturn [\n    chunks: modifiedChunksList\n]",
				"parameters":{
					"inputs":{
						"text":"{{ MZifc.outputs.final_text_response }}",
						"documentTopic":"{{ R0lx9.outputs.documentTopic }}",
						"dummy":"dummy"
					}
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"MANUAL",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":262,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"8XKoa@fAeOt-1@error",
			"id":"kqju6",
			"index":31,
			"inputs":{
				"result":{
					"chunks":{
						"items":{
							"text":"{{ R0lx9.outputs.text }}",
							"metadata":{
								"pageNumber":"{{ R0lx9.outputs.pageNumber }}"
							}
						},
						"ua:type":"mappedArray"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":262,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"fAeOt-1",
			"id":"fpxuE",
			"index":32,
			"inputs":{
				"result":{
					"chunks":{
						"ua:type":"mappedArray",
						"items":{
							"metadata":{
								"pageNumber":"{{ R0lx9.outputs.pageNumber }}",
								"chunkUUID":"{{ 8XKoa.outputs.result.chunks[0].metadata.chunkUUID }}",
								"chunkType":"{{ 8XKoa.outputs.result.chunks[0].metadata.chunkType }}",
								"chunkIndexedType":"{{ 8XKoa.outputs.result.chunks[0].metadata.chunkIndexedType }}",
								"contentForGeneration":"{{ 8XKoa.outputs.result.chunks[0].metadata.contentForGeneration }}",
								"rawText":"{{ 8XKoa.outputs.result.chunks[0].metadata.rawText }}"
							},
							"text":"{{ 8XKoa.outputs.result.chunks[0].text }}"
						},
						"source":"{{ 8XKoa.outputs.result.chunks }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":-1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent",
		"Internal"
	],
	"version":74
}