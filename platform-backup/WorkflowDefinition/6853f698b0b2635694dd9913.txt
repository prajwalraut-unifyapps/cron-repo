{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1751383832516,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1760039505745,
		"deployedBy":-1,
		"deployedDefinitionId":"68e81251e4155b0b0f323861",
		"status":"DEPLOYED",
		"version":82,
		"workflowVersion":101
	},
	"edges":[
		{
			"fromNodeId":"n_uNJ9h",
			"priority":0,
			"skip":false,
			"toNodeId":"eTnok",
			"type":"next"
		},
		{
			"fromNodeId":"eTnok",
			"priority":0,
			"skip":false,
			"toNodeId":"rc5xO",
			"type":"next"
		},
		{
			"fromNodeId":"rc5xO",
			"priority":0,
			"skip":false,
			"toNodeId":"eP8jx",
			"type":"next"
		},
		{
			"fromNodeId":"eP8jx",
			"priority":0,
			"skip":false,
			"toNodeId":"n_mLWwI",
			"type":"next"
		},
		{
			"fromNodeId":"n_mLWwI",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"1GZhm",
			"type":"if"
		},
		{
			"fromNodeId":"1GZhm",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZcoMk",
			"type":"next"
		},
		{
			"fromNodeId":"n_ZcoMk",
			"priority":0,
			"skip":false,
			"toNodeId":"Pki0l",
			"type":"next"
		},
		{
			"fromNodeId":"n_mLWwI",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"Pki0l",
			"type":"next"
		},
		{
			"fromNodeId":"Pki0l",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_A9ahc",
			"type":"if"
		},
		{
			"fromNodeId":"n_A9ahc",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_jHrIf",
			"type":"if"
		},
		{
			"fromNodeId":"n_jHrIf",
			"priority":0,
			"skip":false,
			"toNodeId":"n_bj9Ig",
			"type":"next"
		},
		{
			"fromNodeId":"n_A9ahc",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_bj9Ig",
			"type":"next"
		},
		{
			"fromNodeId":"n_bj9Ig",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Xa9fM",
			"type":"if"
		},
		{
			"fromNodeId":"n_Xa9fM",
			"priority":0,
			"skip":false,
			"toNodeId":"n_tSOq0",
			"type":"next"
		},
		{
			"fromNodeId":"n_bj9Ig",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_QpBT2",
			"type":"next"
		},
		{
			"fromNodeId":"n_tSOq0",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Tan2q",
			"type":"next"
		},
		{
			"fromNodeId":"n_QpBT2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Tan2q",
			"type":"next"
		},
		{
			"fromNodeId":"Pki0l",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Tan2q",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"6853f698b0b2635694dd9913",
	"lastModifiedBy":0,
	"lcName":"add or update tool use details in message",
	"modifiedTime":1760039891958,
	"name":"Add or Update Tool Use Details in Message",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":444,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"n_uNJ9h",
			"index":0,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"status":{
							"type":"string",
							"title":"Status"
						},
						"messageId":{
							"type":"string",
							"title":"Message Id"
						},
						"toolUniqueId":{
							"type":"string",
							"title":"Tool Unique Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"setup":{
					"type":"object",
					"properties":{
						"toolId":{
							"type":"string",
							"title":"toolId"
						},
						"toolName":{
							"type":"string",
							"title":"toolName"
						},
						"toolInput":{
							"type":"object",
							"title":"toolInput"
						},
						"toolOutput":{
							"type":"string",
							"title":"toolOutput"
						},
						"messageId":{
							"type":"string",
							"title":"Message Id"
						},
						"toolUniqueId":{
							"type":"string",
							"title":"Tool Unique Id"
						},
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"createMessageIfAbsent":{
							"type":"boolean",
							"title":"Create Message If Absent"
						},
						"aiAgentId":{
							"type":"string",
							"title":"Ai Agent Id"
						},
						"internalMessageType":{
							"type":"string",
							"title":"Internal Message Type"
						},
						"messageType":{
							"type":"string",
							"title":"Message Type"
						},
						"messageContent":{
							"type":"string",
							"title":"Message Content"
						},
						"streamingInProgress":{
							"type":"boolean",
							"title":"Streaming In Progress"
						},
						"toolExecutionStatus":{
							"type":"boolean",
							"title":"Tool Execution Status"
						},
						"toolResponseTime":{
							"type":"number",
							"title":"Tool Response Time"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":55,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"eTnok",
			"index":0,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"messageId":{
							"type":"string",
							"title":"Message Id"
						},
						"toolUniqueId":{
							"type":"string",
							"title":"Tool Unique Id"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"toolUniqueId":"{{ n_uNJ9h.outputs.toolUniqueId }}",
				"messageId":"{{ n_uNJ9h.outputs.messageId }}"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"messageId":{
							"type":"string",
							"title":"Message Id"
						},
						"toolUniqueId":{
							"type":"string",
							"title":"Tool Unique Id"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"messageId",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":2,
				"resourceName":"storage_by_unifyapps_get_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"rc5xO",
			"index":0,
			"inputs":{
				"object_type":"service_hub_case",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"id":"{{ n_uNJ9h.outputs.caseId }}",
				"readThroughSessionVariables":true
			},
			"skip":false,
			"subTitle":"case",
			"title":"Fetch record by ID",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":56,
				"resourceName":"storage_by_unifyapps_get_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"eP8jx",
			"index":0,
			"inputs":{
				"object_type":"e_ai_agent_conversation_state",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"id":"{{ n_uNJ9h.outputs.caseId }}",
				"readThroughSessionVariables":false
			},
			"skip":false,
			"subTitle":"AI Agent Conversation State",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":437,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"n_mLWwI",
			"index":0,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_uNJ9h.outputs.messageId }}",
						"filter":{
							"operator":"MISSING"
						}
					},
					{
						"property":"{{ n_uNJ9h.outputs.createMessageIfAbsent }}",
						"filter":{
							"operator":"EQUAL",
							"value":"true"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.record.cc.items.name",
					"root.record.cc.items.email",
					"root.record.bcc.items.name",
					"root.record.bcc.items.email",
					"root.record.content.text",
					"root.record.content.type",
					"root.record.content.html",
					"root.record.content.choices.items",
					"root.record.content.coPilotBlocks.blocks.items",
					"root.record.content.coPilotBlocks.role",
					"root.record.content.choiceList.items.id",
					"root.record.content.choiceList.items.title",
					"root.record.content.choiceList.items.url",
					"root.record.content.interfaceDetails.interfaceId",
					"root.record.content.interfaceDetails.pageId",
					"root.record.content.interfaceDetails.slug",
					"root.record.content.interfaceDetails.pageInputs",
					"root.record.content.agentResponse.toolUseDetails.toolId",
					"root.record.content.agentResponse.toolUseDetails.toolName",
					"root.record.content.agentResponse.toolUseDetails.toolInput",
					"root.record.content.agentResponse.toolUseDetails.toolOutput",
					"root.record.content.agentResponse.rawLLMResponse",
					"root.record.to.items.name",
					"root.record.to.items.email",
					"root.record.feedback.userFeedback",
					"root.record.feedback.feedbackCategories.items",
					"root.record.feedback.reaction",
					"root.record.additional.contextMessageId",
					"root.record.additional.rephrasedUserMessage",
					"root.record.additional.sqlQuery",
					"root.record.additional.platformUserId",
					"root.record.additional.temporaryMessage",
					"root.record.additional.internalMessageType",
					"root.record.content.agentResponse.observation",
					"root.record.content.interfaceDetails.interfaceDescription",
					"root.record.content.agentResponse.toolUseDetails.toolResponseTime",
					"root.record.additional.streamingInProgress",
					"root.record.additional.ttsDetails.fileUrl",
					"root.record.additional.parentMessageId",
					"root.record.content.agentResponse.toolUseDetails.toolExecutionStatus"
				]
			},
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":54,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_mLWwI@_0jNvl-1@y",
			"id":"1GZhm",
			"index":0,
			"inputs":{
				"object_type":"service_hub_message",
				"record":{
					"accountId":"{{ __RUN__.outputs.executionId }}",
					"channelName":"{{ rc5xO.outputs.properties.channelName }}",
					"uniqueId":"{{ __RUN__.outputs.executionId }}",
					"toCustomerUserId":"{{ rc5xO.outputs.properties.fromCustomerUserId }}",
					"toCustomerUserIdentityId":"{{ rc5xO.outputs.properties.fromCustomerUserId }}",
					"additional":{
						"internalMessageType":"=IF(ISBLANK({{ n_uNJ9h.outputs.internalMessageType }}),\"AGENT_INTERNAL_RESPONSE\", {{ n_uNJ9h.outputs.internalMessageType }})",
						"parentMessageId":"{{ rc5xO.outputs.properties.lastFanMessageId }}",
						"temporaryMessage":true,
						"streamingInProgress":"{{ n_uNJ9h.outputs.streamingInProgress }}"
					},
					"content":{
						"text":"{{ n_uNJ9h.outputs.messageContent }}"
					},
					"messageId":"{{ __RUN__.outputs.executionId }}",
					"fromCustomerUserId":"{{ eP8jx.outputs.properties.currentAIAgentId }}",
					"type":"=IF(ISBLANK({{ n_uNJ9h.outputs.messageType }}), \"bot\", {{ n_uNJ9h.outputs.messageType }})",
					"fromCustomerUserIdentityId":"{{ n_uNJ9h.outputs.aiAgentId }}",
					"caseId":"{{ n_uNJ9h.outputs.caseId }}"
				}
			},
			"skip":false,
			"subTitle":"create",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":445,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_mLWwI@_0jNvl-1@y",
			"id":"n_ZcoMk",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ eTnok.outputs.messageId }}",
						"value":"{{ 1GZhm.outputs.id }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":52,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"Pki0l",
			"index":0,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_uNJ9h.outputs.messageId }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"messageId present ?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":437,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Pki0l@_0jNvl-1@y",
			"id":"n_A9ahc",
			"index":0,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_uNJ9h.outputs.toolUniqueId }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":2,
				"resourceName":"storage_by_unifyapps_get_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_A9ahc@Pki0l@_0jNvl-1@y@y",
			"id":"n_jHrIf",
			"index":0,
			"inputs":{
				"object_type":"service_hub_message_tool_use_detail",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"id":"{{ eTnok.outputs.toolUniqueId }}",
				"readThroughSessionVariables":true
			},
			"skip":false,
			"subTitle":"ToolUseDetail",
			"title":"Fetch record by ID",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":437,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Pki0l@_0jNvl-1@y",
			"id":"n_bj9Ig",
			"index":0,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_jHrIf.outputs.id }}",
						"filter":{
							"operator":"MISSING"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"new record?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":446,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_bj9Ig@Pki0l@_0jNvl-1@y@y",
			"id":"n_Xa9fM",
			"index":0,
			"inputs":{
				"object_type":"service_hub_message_tool_use_detail",
				"record":{
					"serviceHubMessageId":"{{ eTnok.outputs.messageId }}",
					"toolId":"{{ n_uNJ9h.outputs.toolId }}",
					"toolName":"{{ n_uNJ9h.outputs.toolName }}",
					"toolInput":"{{ n_uNJ9h.outputs.toolInput }}",
					"toolOutput":"{{ n_uNJ9h.outputs.toolOutput }}",
					"toolExecutionStatus":"{{ n_uNJ9h.outputs.toolExecutionStatus }}",
					"toolResponseTime":"{{ n_uNJ9h.outputs.toolResponseTime }}"
				}
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":445,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_bj9Ig@Pki0l@_0jNvl-1@y@y",
			"id":"n_tSOq0",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ eTnok.outputs.toolUniqueId }}",
						"value":"{{ n_Xa9fM.outputs.id }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":437,
				"resourceName":"storage_by_unifyapps_update_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_bj9Ig@Pki0l@_0jNvl-1@y@n",
			"id":"n_QpBT2",
			"index":0,
			"inputs":{
				"recordId":"{{ eTnok.outputs.toolUniqueId }}",
				"object_type":"service_hub_message_tool_use_detail",
				"record":{
					"serviceHubMessageId":"{{ eTnok.outputs.messageId }}",
					"toolId":"{{ n_uNJ9h.outputs.toolId }}",
					"toolName":"{{ n_uNJ9h.outputs.toolName }}",
					"toolInput":"{{ n_uNJ9h.outputs.toolInput }}",
					"toolOutput":"{{ n_uNJ9h.outputs.toolOutput }}",
					"toolExecutionStatus":"{{ n_uNJ9h.outputs.toolExecutionStatus }}",
					"toolResponseTime":"{{ n_uNJ9h.outputs.toolResponseTime }}"
				},
				"upsert":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Update an existing record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":454,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_0jNvl-1",
			"id":"n_Tan2q",
			"index":0,
			"inputs":{
				"result":{
					"status":"OK",
					"toolUniqueId":"{{ eTnok.outputs.toolUniqueId }}",
					"messageId":"{{ eTnok.outputs.messageId }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		
	],
	"version":102
}