{
	"appsUsed":[
		"azure_bot",
		"storage_by_unifyapps"
	],
	"createdTime":1760078583226,
	"deleted":false,
	"edges":[
		{
			"fromNodeId":"_upyrX",
			"priority":0,
			"skip":false,
			"toNodeId":"_FTkow",
			"type":"next"
		},
		{
			"fromNodeId":"_FTkow",
			"priority":0,
			"skip":false,
			"toNodeId":"_KntEb",
			"type":"next"
		},
		{
			"fromNodeId":"_KntEb",
			"priority":0,
			"skip":false,
			"toNodeId":"kxwmp",
			"type":"next"
		},
		{
			"fromNodeId":"kxwmp",
			"priority":0,
			"skip":false,
			"toNodeId":"aaUV2",
			"type":"next"
		},
		{
			"fromNodeId":"aaUV2",
			"priority":0,
			"skip":false,
			"toNodeId":"6n77X",
			"type":"next"
		},
		{
			"fromNodeId":"6n77X",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"Mwu8T",
			"type":"if"
		},
		{
			"fromNodeId":"Mwu8T",
			"priority":0,
			"skip":false,
			"toNodeId":"_I8J6v",
			"type":"next"
		},
		{
			"fromNodeId":"6n77X",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"_I8J6v",
			"type":"next"
		},
		{
			"fromNodeId":"_I8J6v",
			"priority":0,
			"skip":false,
			"toNodeId":"_cvDyy",
			"type":"next"
		},
		{
			"fromNodeId":"_cvDyy",
			"priority":0,
			"skip":false,
			"toNodeId":"n_hYR8M",
			"type":"next"
		},
		{
			"fromNodeId":"n_hYR8M",
			"priority":0,
			"skip":false,
			"toNodeId":"_5F9t3",
			"type":"next"
		}
	],
	"id":"68e8aaf72ea336186660e624",
	"lastModifiedBy":33877,
	"lcName":"azure bot trigger (ai agent)",
	"modifiedTime":1760078583226,
	"name":"Azure Bot Trigger (AI Agent)",
	"nodes":[
		{
			"context":{
				"appName":"azure_bot",
				"resourceVersion":627,
				"resourceName":"azure_bot_on_new_message"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"_upyrX",
			"index":1,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"{{ _upyrX.outputs.text }}",
							"filter":{
								"operator":"EXISTS"
							}
						},
						{
							"property":"=LEN({{ _upyrX.outputs.text }})",
							"filter":{
								"operator":"GT",
								"value":"0"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"subTitle":"Azure Bot",
			"title":"On new message",
			"trigger":{
				"type":"EVENT"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":84,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"_FTkow",
			"index":2,
			"inputs":{
				"automationId":"6707e3c40e381a37b25270b8",
				"runtimeConnections":{
					"microsoft_teams":"<<_ua_ai_agent.inputs.teamsConnectionId>>"
				},
				"synchronous":true,
				"triggerWorkflowWithRuntimeType":"IN_MEMORY",
				"version":"-1",
				"parameters":{
					"userId":"{{ _upyrX.outputs.from.aadObjectId }}"
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"cacheKey":"{{ _upyrX.outputs.from.aadObjectId }}",
					"enabled":true,
					"timeToLive":"3600",
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				},
				"timeoutConfig":{
					"enabled":false
				}
			},
			"skip":false,
			"subTitle":"get Teams User",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":816,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"_KntEb",
			"index":3,
			"inputs":{
				"automationId":"66eaeecb5dd77636e1fcc1f9",
				"runtimeConnections":{
					"microsoft_teams":"<<_ua_ai_agent.inputs.teamsConnectionId>>"
				},
				"synchronous":true,
				"triggerWorkflowWithRuntimeType":"IN_MEMORY",
				"version":"-1",
				"parameters":{
					"channelName":"AZURE_BOT",
					"channelSpecificId":"{{ _upyrX.outputs.from.aadObjectId }}"
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"cacheKey":"{{ _upyrX.outputs.from.aadObjectId }}",
					"enabled":true,
					"timeToLive":"3600",
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				},
				"timeoutConfig":{
					"enabled":false
				}
			},
			"skip":false,
			"subTitle":"g/c CustomerProfile",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":15,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"kxwmp",
			"index":4,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_type",
							"filter":{
								"operator":"EQUAL",
								"value":"fan"
							}
						},
						{
							"property":"properties_fromCustomerUserId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ _KntEb.outputs.customerProfileId }}"
							}
						},
						{
							"property":"cTm",
							"filter":{
								"operator":"GTE",
								"value":"=INT((NOW() - DATE(1970,1,1)) * 86400000 - 900000)"
							}
						},
						{
							"property":"properties_toCustomerUserId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ _upyrX.outputs.recipient.id }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"service_hub_message",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"cTm",
						"order":"DESC"
					}
				],
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":20
				},
				"numberOfRecordsToFetch":"SINGLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"fan msg last 15 mins",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":15,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"aaUV2",
			"index":5,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						}
					},
					"required":[]
				}
			},
			"inputs":{},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"_ua_variableDetails":{
							"type":"array",
							"title":"Variable Details",
							"items":{
								"properties":{
									"description":{
										"description":"Description of the variable",
										"type":"string"
									},
									"dataType":{
										"description":"Data type of the variable",
										"type":"string"
									},
									"name":{
										"description":"Name of the variable",
										"type":"string"
									}
								},
								"type":"object"
							}
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":15,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"6n77X",
			"index":6,
			"inputs":{
				"filters":[
					{
						"property":"{{ kxwmp.outputs.id }}",
						"filter":{
							"operator":"EXISTS"
						}
					},
					{
						"property":"=LOWER({{ _upyrX.outputs.text }})",
						"filter":{
							"operator":"NOT_CONTAINS",
							"value":"new session"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"caseId present",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":15,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"6n77X@_becCv-1@y",
			"id":"Mwu8T",
			"index":7,
			"inputs":{
				"variables":[
					{
						"source":"{{ aaUV2.outputs.caseId }}",
						"value":"{{ kxwmp.outputs.properties.caseId }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":84,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"_I8J6v",
			"index":8,
			"inputs":{
				"automationId":"674afe5adefb851816d61959",
				"runtimeConnections":{},
				"synchronous":true,
				"triggerWorkflowWithRuntimeType":"IN_MEMORY",
				"version":"-1",
				"parameters":{
					"channelName":"AZURE_BOT",
					"text":"{{ _upyrX.outputs.text }}",
					"triggerInput":"{{ _upyrX.outputs }}",
					"caseAssociationType":"NEW_CASE_ON_EVERY_MESSAGE",
					"messageType":"FAN",
					"caseId":"{{ aaUV2.outputs.caseId }}",
					"triggeredFromAutomationId":"{{ __RUN__.outputs.workflowId }}",
					"fromCustomerUserId":"{{ _KntEb.outputs.customerProfileId }}",
					"toCustomerUserId":"{{ _upyrX.outputs.recipient.id }}",
					"channelSpecificUserId":"{{ _upyrX.outputs.from.aadObjectId }}",
					"attachments":{
						"source":"{{ _upyrX.outputs.attachments }}",
						"ua:type":"mappedArray",
						"items":"{{ _upyrX.outputs.attachments[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Case Management",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":79,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"_cvDyy",
			"index":9,
			"inputs":{
				"automationId":"6732f70850384a29acf312fd",
				"runtimeConnections":{},
				"synchronous":false,
				"triggerWorkflowWithRuntimeType":"IN_MEMORY",
				"runInUserContext":"{{ _b9qRW.outputs.userId }}",
				"version":"-1",
				"parameters":{
					"userQuery":"{{ _upyrX.outputs.text }}",
					"caseId":"{{ _I8J6v.outputs.caseId }}",
					"messageId":"{{ _I8J6v.outputs.messageId }}",
					"userEmailAddress":"{{ _FTkow.outputs.emailAddress }}",
					"aiAgentId":"<AI_AGENT_ID>"
				}
			},
			"skip":false,
			"subTitle":"Trigger AI Agent",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"azure_bot",
				"resourceVersion":2,
				"resourceName":"azure_bot_send_typing_activity",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"n_hYR8M",
			"index":10,
			"inputs":{
				"conversationId":"{{ _upyrX.outputs.conversation.id }}"
			},
			"skip":false,
			"subTitle":"Azure Bot",
			"title":"Send typing activity",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"stop"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_becCv-1",
			"id":"_5F9t3",
			"index":11,
			"skip":false,
			"subTitle":"Stop",
			"title":"Stop",
			"type":"STOP"
		}
	],
	"ownerUserId":33877,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":false,
	"version":0
}