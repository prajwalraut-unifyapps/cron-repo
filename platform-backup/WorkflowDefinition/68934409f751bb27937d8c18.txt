{
	"appsUsed":[
		
	],
	"createdTime":1758530450665,
	"deleted":false,
	"edges":[
		{
			"fromNodeId":"n_iXkFJ",
			"priority":0,
			"skip":false,
			"toNodeId":"n_WqubO",
			"type":"next"
		},
		{
			"fromNodeId":"n_WqubO",
			"priority":0,
			"skip":false,
			"toNodeId":"n_HNzcR",
			"type":"next"
		},
		{
			"fromNodeId":"n_HNzcR",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_zIxMJ",
			"type":"if"
		},
		{
			"fromNodeId":"n_zIxMJ",
			"priority":0,
			"skip":false,
			"toNodeId":"n_hFU9v",
			"type":"next"
		},
		{
			"fromNodeId":"n_HNzcR",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_hFU9v",
			"type":"next"
		},
		{
			"fromNodeId":"n_hFU9v",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_pg9V9",
			"type":"if"
		},
		{
			"fromNodeId":"n_pg9V9",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF",
			"type":"next"
		},
		{
			"fromNodeId":"n_hFU9v",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"1",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@1",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@1",
			"priority":0,
			"skip":false,
			"toNodeId":"_62oxO",
			"type":"next"
		},
		{
			"fromNodeId":"_62oxO",
			"priority":0,
			"skip":false,
			"toNodeId":"_ptr2s",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@2",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_rheSg",
			"type":"next"
		},
		{
			"fromNodeId":"n_rheSg",
			"priority":0,
			"skip":false,
			"toNodeId":"n_VWSXA",
			"type":"next"
		},
		{
			"fromNodeId":"n_VWSXA",
			"priority":0,
			"skip":false,
			"toNodeId":"9p1oe",
			"type":"next"
		},
		{
			"fromNodeId":"9p1oe",
			"priority":0,
			"skip":false,
			"toNodeId":"1q6LI",
			"type":"next"
		},
		{
			"fromNodeId":"1q6LI",
			"priority":0,
			"skip":false,
			"toNodeId":"_J2puU",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"3",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@3",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@3",
			"priority":0,
			"skip":false,
			"toNodeId":"n_cEL1x",
			"type":"next"
		},
		{
			"fromNodeId":"n_cEL1x",
			"priority":0,
			"skip":false,
			"toNodeId":"_sBcrn",
			"type":"next"
		},
		{
			"fromNodeId":"_sBcrn",
			"priority":0,
			"skip":false,
			"toNodeId":"_ADUIN",
			"type":"next"
		},
		{
			"fromNodeId":"_ADUIN",
			"priority":0,
			"skip":false,
			"toNodeId":"_VwV9q",
			"type":"next"
		},
		{
			"fromNodeId":"_VwV9q",
			"priority":0,
			"skip":false,
			"toNodeId":"_bWl6z",
			"type":"next"
		},
		{
			"fromNodeId":"_bWl6z",
			"priority":0,
			"skip":false,
			"toNodeId":"n_7ApTh",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"4",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@4",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@4",
			"priority":0,
			"skip":false,
			"toNodeId":"n_fsbnP",
			"type":"next"
		},
		{
			"fromNodeId":"n_fsbnP",
			"priority":0,
			"skip":false,
			"toNodeId":"_4bJ2V",
			"type":"next"
		},
		{
			"fromNodeId":"_4bJ2V",
			"priority":0,
			"skip":false,
			"toNodeId":"n_0LROC",
			"type":"next"
		},
		{
			"fromNodeId":"n_0LROC",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ws6Lc",
			"type":"next"
		},
		{
			"fromNodeId":"n_ws6Lc",
			"priority":0,
			"skip":false,
			"toNodeId":"n_womFq",
			"type":"next"
		},
		{
			"fromNodeId":"n_womFq",
			"priority":0,
			"skip":false,
			"toNodeId":"n_AP7VQ",
			"type":"loop"
		},
		{
			"fromNodeId":"n_AP7VQ",
			"priority":0,
			"skip":false,
			"toNodeId":"_M89KD",
			"type":"next"
		},
		{
			"fromNodeId":"_M89KD",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZZMrM",
			"type":"next"
		},
		{
			"fromNodeId":"n_ZZMrM",
			"priority":0,
			"skip":false,
			"toNodeId":"_RitcW",
			"type":"next"
		},
		{
			"fromNodeId":"_RitcW",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"n_womFq",
			"type":"next"
		},
		{
			"fromNodeId":"n_womFq",
			"priority":0,
			"skip":false,
			"toNodeId":"n_3iQkh",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"5",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@5",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@5",
			"priority":0,
			"skip":false,
			"toNodeId":"_2aKRT",
			"type":"next"
		},
		{
			"fromNodeId":"_2aKRT",
			"priority":0,
			"skip":false,
			"toNodeId":"_k2kNM",
			"type":"next"
		},
		{
			"fromNodeId":"_k2kNM",
			"priority":0,
			"skip":false,
			"toNodeId":"n_XSX6a",
			"type":"next"
		},
		{
			"fromNodeId":"n_XSX6a",
			"priority":0,
			"skip":false,
			"toNodeId":"n_JRXzG",
			"type":"next"
		},
		{
			"fromNodeId":"n_JRXzG",
			"priority":0,
			"skip":false,
			"toNodeId":"_tjY4N",
			"type":"next"
		},
		{
			"fromNodeId":"_tjY4N",
			"priority":0,
			"skip":false,
			"toNodeId":"_seAjO",
			"type":"next"
		},
		{
			"fromNodeId":"_seAjO",
			"priority":0,
			"skip":false,
			"toNodeId":"n_nx4j5",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"6",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@6",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@6",
			"priority":0,
			"skip":false,
			"toNodeId":"_YmSVh",
			"type":"next"
		},
		{
			"fromNodeId":"_YmSVh",
			"priority":0,
			"skip":false,
			"toNodeId":"n_71NyR",
			"type":"next"
		},
		{
			"fromNodeId":"n_71NyR",
			"priority":0,
			"skip":false,
			"toNodeId":"n_i5FEn",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"7",
			"priority":0,
			"skip":false,
			"toNodeId":"n_knqDF@7",
			"type":"branch"
		},
		{
			"fromNodeId":"n_knqDF@7",
			"priority":0,
			"skip":false,
			"toNodeId":"_prtKB",
			"type":"next"
		},
		{
			"fromNodeId":"_prtKB",
			"priority":0,
			"skip":false,
			"toNodeId":"_LXfNh",
			"type":"next"
		},
		{
			"fromNodeId":"_ptr2s",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"_J2puU",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"n_7ApTh",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"n_3iQkh",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"n_nx4j5",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"n_i5FEn",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"_LXfNh",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"next"
		},
		{
			"fromNodeId":"n_knqDF",
			"name":"default",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZPgAK",
			"type":"branch"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"68934409f751bb27937d8c18",
	"lastModifiedBy":-1,
	"lcName":"metering | users | actual",
	"modifiedTime":1758530879900,
	"name":"Metering | Users | Actual",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":102,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_vXQLK-1",
			"id":"n_iXkFJ",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"meteringResult":{
							"type":"object",
							"properties":{
								"totalUsers":{
									"type":"integer",
									"title":"Total Users"
								},
								"weeklyActiveUsers":{
									"type":"integer",
									"title":"Weekly Active Users"
								},
								"averageSessionDuration":{
									"type":"string",
									"title":"Average Session Duration"
								},
								"userRetention":{
									"type":"number",
									"title":"User Retention"
								},
								"sessionPerUserDistribution":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"bucket":{
												"type":"string",
												"title":"Bucket"
											},
											"count":{
												"type":"integer",
												"title":"Count"
											}
										},
										"additionalProperties":false,
										"required":[
											"bucket",
											"count"
										]
									},
									"title":"Session Per User Distribution"
								},
								"userCostAnalysis":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"name":{
												"type":"string",
												"title":"Name"
											},
											"totalQueries":{
												"type":"integer",
												"title":"Total Queries"
											},
											"totalSessions":{
												"type":"integer",
												"title":"Total Sessions"
											},
											"totalAgents":{
												"type":"integer",
												"title":"Total Agents"
											},
											"totalCost":{
												"type":"number",
												"title":"Total Cost"
											},
											"costPerSession":{
												"type":"number",
												"title":"Cost Per Session"
											},
											"role":{
												"type":"string",
												"title":"Role"
											},
											"totalTokens":{
												"type":"integer",
												"title":"Total Tokens"
											}
										},
										"additionalProperties":false,
										"required":[
											"name",
											"totalQueries",
											"totalSessions",
											"totalAgents",
											"totalCost",
											"costPerSession",
											"role",
											"totalTokens"
										]
									},
									"title":"User Cost Analysis"
								},
								"activeUsersTrend":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"timestamp":{
												"type":"integer",
												"title":"Timestamp"
											},
											"dau":{
												"type":"integer",
												"title":"Dau"
											},
											"mau":{
												"type":"integer",
												"title":"Mau"
											}
										},
										"additionalProperties":false,
										"required":[
											"timestamp",
											"dau",
											"mau"
										]
									},
									"title":"Active Users Trend"
								},
								"usageTrend":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"timestamp":{
												"type":"string",
												"title":"Timestamp"
											},
											"avgUserCount":{
												"type":"string",
												"title":"Avg User Count"
											}
										},
										"additionalProperties":false,
										"required":[
											"timestamp",
											"avgUserCount"
										]
									},
									"title":"Usage Trend"
								},
								"topTopics":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"topicName":{
												"type":"string",
												"title":"Topic Name"
											},
											"count":{
												"type":"integer",
												"title":"Count"
											}
										},
										"additionalProperties":false,
										"required":[
											"topicName",
											"count"
										]
									},
									"title":"Top Topics"
								},
								"totalUsersCount":{
									"type":"integer",
									"title":"Total Users Count"
								},
								"peakRange":{
									"type":"string",
									"title":"Peak Range"
								},
								"peak_users":{
									"type":"integer",
									"title":"Peak Users"
								}
							},
							"additionalProperties":false,
							"title":"Metering Result",
							"required":[
								"totalUsers",
								"weeklyActiveUsers",
								"averageSessionDuration",
								"userRetention",
								"sessionPerUserDistribution",
								"userCostAnalysis",
								"activeUsersTrend",
								"usageTrend",
								"topTopics",
								"totalUsersCount"
							]
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"setup":{
					"type":"object",
					"properties":{
						"startDate":{
							"type":"string",
							"title":"Start Date"
						},
						"endDate":{
							"type":"string",
							"title":"End Date"
						},
						"filter":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Filter"
						},
						"offset":{
							"type":"integer",
							"title":"Offset"
						},
						"limit":{
							"type":"integer",
							"title":"Limit"
						}
					},
					"additionalProperties":false,
					"required":[
						"offset",
						"limit"
					]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":101,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_vXQLK-1",
			"id":"n_WqubO",
			"index":2,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"offset":{
							"type":"integer",
							"title":"Offset"
						},
						"limit":{
							"type":"integer",
							"title":"Limit"
						}
					},
					"required":[
						"offset",
						"limit"
					]
				}
			},
			"inputs":{
				"offset":"{{ n_iXkFJ.outputs.offset }}",
				"limit":"{{ n_iXkFJ.outputs.limit }}"
			},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"offset":{
							"type":"integer",
							"title":"Offset"
						},
						"limit":{
							"type":"integer",
							"title":"Limit"
						}
					},
					"required":[
						"offset",
						"limit"
					]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":101,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_vXQLK-1",
			"id":"n_HNzcR",
			"index":3,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_WqubO.outputs.offset }}",
						"filter":{
							"operator":"MISSING"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_HNzcR@_vXQLK-1@y",
			"id":"n_zIxMJ",
			"index":4,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_WqubO.outputs.offset }}",
						"value":0
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":101,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_vXQLK-1",
			"id":"n_hFU9v",
			"index":5,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_WqubO.outputs.limit }}",
						"filter":{
							"operator":"MISSING"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_hFU9v@_vXQLK-1@y",
			"id":"n_pg9V9",
			"index":6,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_WqubO.outputs.limit }}",
						"value":10
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_vXQLK-1",
			"id":"n_knqDF",
			"index":7,
			"inputs":{
				"branches":[
					{
						"id":"1",
						"inputs":{
							"name":"Total Users"
						}
					},
					{
						"id":"2",
						"inputs":{
							"name":"Average session"
						}
					},
					{
						"id":"3",
						"inputs":{
							"name":"Users retention"
						}
					},
					{
						"id":"4",
						"inputs":{
							"name":"DAU trend"
						}
					},
					{
						"id":"5",
						"inputs":{
							"name":"User Cost Analysis"
						}
					},
					{
						"id":"6",
						"inputs":{
							"name":"Usage Trend"
						}
					},
					{
						"id":"7",
						"inputs":{
							"name":"Fav Topics"
						}
					},
					{
						"id":"default"
					}
				]
			},
			"skip":false,
			"subTitle":"Branch",
			"title":"",
			"type":"BRANCH"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@1",
			"id":"n_knqDF@1",
			"index":8,
			"inputs":{
				"name":"Total Users"
			},
			"skip":false,
			"subTitle":"Active model ",
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@1",
			"id":"_62oxO",
			"index":9,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_e_traces=::=userId",
						"aggregationFunction":"GROUP",
						"alias":"userId",
						"includePercentageChange":false
					},
					{
						"name":"ENTITY_e_traces=::=caseId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"caseCount",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"ENTITY_e_traces=::=fromAutomationId",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"ENTITY_e_traces",
				"includeTotalHits":true,
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[
					{
						"field":"caseCount",
						"order":"DESC"
					}
				],
				"timeFilter":{
					"since":"{{ n_iXkFJ.outputs.startDate }}",
					"until":"{{ n_iXkFJ.outputs.endDate }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				}
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@1",
			"id":"_ptr2s",
			"index":10,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"result":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"bucket":{
										"type":"string",
										"title":"Bucket"
									},
									"count":{
										"type":"integer",
										"title":"Count"
									}
								},
								"additionalProperties":false,
								"required":[
									"bucket",
									"count"
								]
							},
							"title":"Result"
						}
					},
					"additionalProperties":false,
					"required":[
						"result"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"caseCounts":{
							"type":"array",
							"items":{
								"type":"integer"
							},
							"title":"Case Counts"
						}
					},
					"additionalProperties":false,
					"required":[
						"caseCounts"
					]
				},
				"compile_static":false,
				"code":"List<Map<String, Object>> bucketize(List<Integer> input) {\n    def buckets = [\n        \"1\"      : 0,\n        \"2-5\"    : 0,\n        \"6-10\"   : 0,\n        \"11-20\"  : 0,\n        \"21-50\"  : 0,\n        \"51-100\" : 0,\n        \"100+\"   : 0\n    ]\n\n    input.each { num ->\n        if (num == 1) {\n            buckets[\"1\"]++\n        } else if (num >= 2 && num <= 5) {\n            buckets[\"2-5\"]++\n        } else if (num >= 6 && num <= 10) {\n            buckets[\"6-10\"]++\n        } else if (num >= 11 && num <= 20) {\n            buckets[\"11-20\"]++\n        } else if (num >= 21 && num <= 50) {\n            buckets[\"21-50\"]++\n        } else if (num >= 51 && num <= 100) {\n            buckets[\"51-100\"]++\n        } else {\n            buckets[\"100+\"]++\n        }\n    }\n\n    return buckets.collect { key, value ->\n        [bucket: key, count: value]\n    }\n}\n\n// Just return the list directly\nreturn ['result': bucketize(caseCounts)]\n",
				"parameters":{
					"caseCounts":{
						"source":"{{ _62oxO.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":"{{ _62oxO.outputs.objects[0].columns.caseCount }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Combine result",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@2",
			"id":"n_knqDF@2",
			"index":11,
			"inputs":{
				"name":"Average session"
			},
			"skip":false,
			"subTitle":"Total number of requests",
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":103,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@2",
			"id":"n_rheSg",
			"index":12,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_service_hub_case=::=ID",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"totalCases",
						"includePercentageChange":false
					}
				],
				"entityType":"ENTITY_service_hub_case",
				"page":{
					"offset":0,
					"limit":10000
				},
				"timeFilter":{
					"since":"{{ n_iXkFJ.outputs.startDate }}",
					"until":"{{ n_iXkFJ.outputs.endDate }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":456,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@2",
			"id":"n_VWSXA",
			"index":13,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_service_hub_message=::=additional__responseTime",
						"aggregationFunction":"SUM",
						"alias":"totalResponseTime",
						"includePercentageChange":false
					}
				],
				"entityType":"ENTITY_service_hub_message",
				"timeFilter":{
					"since":"{{ n_iXkFJ.outputs.startDate }}",
					"until":"{{ n_iXkFJ.outputs.endDate }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":58,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@2",
			"id":"9p1oe",
			"index":14,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"sqlQuery":{
							"type":"string",
							"title":"sqlQuery"
						}
					},
					"additionalProperties":false
				},
				"input":{
					"type":"object",
					"properties":{
						"limit":{
							"type":"integer",
							"title":"Limit"
						},
						"offset":{
							"type":"string",
							"title":"Offset"
						},
						"timestampStart":{
							"type":"string",
							"title":"Timestamp Start"
						},
						"timestampEnd":{
							"type":"string",
							"title":"Timestamp End"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"import java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\n\ndef generateQuery(startTime, endTime) {\n    return \"\"\"\n    SELECT AVG(SessionDuration) AS AvgSessionDuration\n    FROM (\n        SELECT \n            CAST(we.startNodeOutput -> 'messageId' AS string) AS SessionID,\n            (MAX(we.endTime) - MIN(we.startTime)) AS SessionDuration\n        FROM WORKFLOW_NODE_EXECUTION wne\n        JOIN WORKFLOW_EXECUTION we \n            ON (\n                wne.executionInstanceId = we.id OR\n                wne.rootExecutionInstanceId = we.rootExecutionInstanceId OR\n                wne.parentExecutionInstanceId = we.id OR\n                wne.rootExecutionInstanceId = we.id\n            )\n        WHERE \n            CAST(we.startNodeOutput -> 'messageId' AS string) IS NOT NULL\n            AND wne.entryTime BETWEEN ${startTime} AND ${endTime}\n            AND we.startTime BETWEEN ${startTime} AND ${endTime}\n            AND we.workflowId IN ('66ac70650f725f5b425d12d8', '66966960e8797a59f4a46292')\n            AND wne.workflowId IN ('66ac70650f725f5b425d12d8', '66966960e8797a59f4a46292')\n            AND currentNodeId IN ('27dr9', 'vBzOH')\n        GROUP BY SessionID\n    ) AS Sessions;\n    \"\"\".stripIndent().trim()\n}\n\ndef getEpochMillis(String timestamp) {\n    ZonedDateTime zdt = ZonedDateTime.parse(timestamp, DateTimeFormatter.ISO_DATE_TIME)\n    return zdt.toInstant().toEpochMilli()\n}\n\ndef normalizeToStartOfDay(input) {\n    def formatter = DateTimeFormatter.ISO_OFFSET_DATE_TIME\n    def zoned = ZonedDateTime.parse(input, formatter)\n    def startOfDay = zoned.toLocalDate().atStartOfDay(zoned.getZone())\n    return formatter.format(startOfDay)\n}\n\n\ndef startTime = getEpochMillis(normalizeToStartOfDay(timestampStart))\ndef endTime = getEpochMillis(normalizeToStartOfDay(timestampEnd))\n\ndef sqlQuery = generateQuery(startTime, endTime)\n\nreturn [sqlQuery: sqlQuery]\n",
				"isAsync":false,
				"parameters":{
					"offset":"0",
					"limit":1000,
					"timestampStart":"{{ n_iXkFJ.outputs.startDate }}",
					"timestampEnd":"{{ n_iXkFJ.outputs.endDate }}"
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false,
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":true,
			"subTitle":"Generate SQL",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":18,
				"resourceName":"analytics_by_unifyapps_execute_query",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@2",
			"id":"1q6LI",
			"index":15,
			"inputs":{
				"outputSchema":{
					"type":"object",
					"properties":{
						"columns":{
							"type":"object",
							"properties":{
								"AvgSessionDuration":{
									"type":"number",
									"title":"AvgSessionDuration"
								}
							},
							"title":"columns",
							"additionalProperties":false,
							"required":[]
						}
					},
					"additionalProperties":false
				},
				"query":"{{ 9p1oe.outputs.result.sqlQuery }}",
				"group":"PLATFORM"
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"cacheKey":"{{ 9p1oe.outputs.result.sqlQuery }}",
					"enabled":true,
					"timeToLive":"7200",
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":true,
			"subTitle":"Execute SQL",
			"title":"Execute Analytics SQL Query",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				}
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@2",
			"id":"_J2puU",
			"index":16,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"result"
					],
					"properties":{
						"result":{
							"type":"string",
							"title":"Result"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"totalResponseTime",
						"totalSession"
					],
					"properties":{
						"totalResponseTime":{
							"type":"number",
							"title":"Total Response Time"
						},
						"totalSession":{
							"type":"integer",
							"title":"Total Session"
						}
					}
				},
				"code":"String formatDuration(double millis) {\n    long totalSeconds = (long)(millis / 1000)\n    long hours = totalSeconds / 3600\n    long minutes = (totalSeconds % 3600) / 60\n    long seconds = totalSeconds % 60\n\n    def parts = []\n    if (hours > 0) parts << (\"\" + hours + \"hr\")\n    if (minutes > 0 || hours > 0) parts << (\"\" + minutes + \"m\")\n    parts << (\"\" + seconds + \"s\")\n\n    return parts.join(\" \")\n}\n\ndef result = '-'\n\n\ndef totalSession=binding.hasVariable(\"totalSession\")?totalSession as Integer:null\ndef totalResTime=binding.hasVariable(\"totalResponseTime\")?totalResponseTime as double:null\nif(totalResTime!=null&&totalSession!=null)\n{\n    def value=(totalResTime/totalSession)\n    result = formatDuration(value)\n}\nelse\n{\n    result=0\n}\nreturn ['result': result]\n",
				"compile_static":false,
				"parameters":{
					"totalResponseTime":"{{ n_VWSXA.outputs.objects[0].columns.totalResponseTime }}",
					"totalSession":"{{ n_rheSg.outputs.objects[0].columns.totalCases }}"
				}
			},
			"skip":false,
			"subTitle":"Combine result",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"n_knqDF@3",
			"index":17,
			"inputs":{
				"name":"Users retention"
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"n_cEL1x",
			"index":18,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"from":{
							"type":"integer",
							"title":"From"
						},
						"to":{
							"type":"integer",
							"title":"To"
						},
						"lastFrom":{
							"type":"integer",
							"title":"Last From"
						},
						"lastTo":{
							"type":"integer",
							"title":"Last To"
						}
					},
					"additionalProperties":false,
					"required":[
						"from",
						"to",
						"lastFrom",
						"lastTo"
					]
				},
				"compile_static":false,
				"code":"import java.time.*\nimport java.time.format.DateTimeFormatter\n\n// Use UTC zone\nZoneId zone = ZoneOffset.UTC\n\n// Formatter without timezone\nDateTimeFormatter formatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n\n// Today at 00:00 UTC\nZonedDateTime todayStart = LocalDate.now(zone).atStartOfDay(zone)\n\n// 1 week ago and 2 weeks ago\nZonedDateTime weekAgoStart = todayStart.minusWeeks(1)\nZonedDateTime twoWeekAgoStart = todayStart.minusWeeks(2)\n\n// Format and manually append +00:00\nString to = todayStart.minusSeconds(1).format(formatter) + \"+00:00\"\nString from = weekAgoStart.format(formatter) + \"+00:00\"\nString lastFrom = twoWeekAgoStart.format(formatter) + \"+00:00\"\nString lastTo = weekAgoStart.minusSeconds(1).format(formatter) + \"+00:00\"\n\nreturn ['from': from, 'to': to, 'lastFrom': lastFrom, 'lastTo': lastTo]\n"
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"_sBcrn",
			"index":19,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_e_traces=::=userId",
						"aggregationFunction":"GROUP",
						"alias":"userId",
						"includePercentageChange":false
					},
					{
						"name":"ENTITY_e_traces=::=caseId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"caseCount",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"ENTITY_e_traces=::=fromAutomationId",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"ENTITY_e_traces",
				"includeTotalHits":true,
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[],
				"timeFilter":{
					"since":"{{ n_cEL1x.outputs.result.from }}",
					"until":"{{ n_cEL1x.outputs.result.to }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"_ADUIN",
			"index":20,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_e_traces=::=userId",
						"aggregationFunction":"GROUP",
						"alias":"userId",
						"includePercentageChange":false
					},
					{
						"name":"ENTITY_e_traces=::=caseId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"caseCount",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"ENTITY_e_traces=::=fromAutomationId",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"ENTITY_e_traces",
				"includeTotalHits":true,
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[],
				"timeFilter":{
					"since":"{{ n_cEL1x.outputs.result.lastFrom }}",
					"until":"{{ n_cEL1x.outputs.result.lastTo }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"_VwV9q",
			"index":21,
			"inputs":{
				"projections":[
					{
						"aggregationFunction":"GROUP",
						"includePercentageChange":false,
						"name":"USER_ID",
						"alias":"userId"
					},
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"CASE_ID",
						"alias":"count"
					}
				],
				"filter":{
					"filters":[
						{
							"property":"WORKFLOW_ID",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"WORKFLOW_EXECUTION",
				"page":{
					"offset":0,
					"limit":1000
				},
				"timeFilter":{
					"since":"{{ n_cEL1x.outputs.result.from }}",
					"until":"{{ n_cEL1x.outputs.result.to }}"
				},
				"group":"PLATFORM"
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"cacheKey":"{{ n_cEL1x.outputs.result.from }}",
					"enabled":true,
					"timeToLive":"3600",
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":true,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"_bWl6z",
			"index":22,
			"inputs":{
				"projections":[
					{
						"aggregationFunction":"GROUP",
						"includePercentageChange":false,
						"name":"USER_ID",
						"alias":"userId"
					},
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"CASE_ID",
						"alias":"count"
					}
				],
				"filter":{
					"filters":[
						{
							"property":"WORKFLOW_ID",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"WORKFLOW_EXECUTION",
				"page":{
					"offset":0,
					"limit":1000
				},
				"timeFilter":{
					"since":"{{ n_cEL1x.outputs.result.lastFrom }}",
					"until":"{{ n_cEL1x.outputs.result.lastTo }}"
				},
				"group":"PLATFORM"
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"cacheKey":"{{ n_cEL1x.outputs.result.from }}",
					"enabled":true,
					"timeToLive":"3600",
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":true,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@3",
			"id":"n_7ApTh",
			"index":23,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"weeklyActiveUsers":{
							"type":"string",
							"title":"Weekly Active Users"
						},
						"userRetention":{
							"type":"number",
							"title":"User Retention"
						}
					},
					"additionalProperties":false,
					"required":[
						"weeklyActiveUsers",
						"userRetention"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"currentWeekUsers":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Current Week Users"
						},
						"prevWeekUsers":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Prev Week Users"
						}
					},
					"additionalProperties":false,
					"required":[
						"currentWeekUsers",
						"prevWeekUsers"
					]
				},
				"compile_static":false,
				"code":"double calculateUserOverlapPercentage(List<String> listA, List<String> listB) {\n    if (!listA) return 0.0\n\n    def setB = listB.toSet()\n    def commonCount = listA.count { userId -> setB.contains(userId) }\n\n    def percentage = (commonCount * 100.0) / listA.size()\n    return Math.round(percentage * 100) / 100.0  // Round to 2 decimal places\n}\n\n\n\ndef result = [:]\nresult['weeklyActiveUsers'] = 0\nresult['userRetention'] = 0.0\nif(binding.hasVariable('currentWeekUsers')) {\n  result['weeklyActiveUsers'] = currentWeekUsers.unique().size()\n\n  if(binding.hasVariable('prevWeekUsers')) {\n    result['userRetention'] = calculateUserOverlapPercentage(prevWeekUsers, currentWeekUsers)\n  }\n}\nreturn result\n",
				"parameters":{
					"currentWeekUsers":{
						"ua:type":"mappedArray",
						"items":"{{ _sBcrn.outputs.objects[0].columns.userId }}",
						"source":"{{ _sBcrn.outputs.objects }}"
					},
					"prevWeekUsers":{
						"ua:type":"mappedArray",
						"items":"{{ _ADUIN.outputs.objects[0].columns.userId }}",
						"source":"{{ _ADUIN.outputs.objects }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Combine result",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"n_knqDF@4",
			"index":24,
			"inputs":{
				"name":"DAU trend"
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"n_fsbnP",
			"index":25,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"startEpoch":{
							"type":"integer",
							"title":"Start Epoch"
						},
						"endEpoch":{
							"type":"integer",
							"title":"End Epoch"
						}
					},
					"additionalProperties":false,
					"required":[
						"startEpoch",
						"endEpoch"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"startDate":{
							"type":"string",
							"title":"Start Date"
						},
						"endDate":{
							"type":"string",
							"title":"End Date"
						}
					},
					"additionalProperties":false,
					"required":[
						"startDate",
						"endDate"
					]
				},
				"compile_static":false,
				"code":"import java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\ndef formatter = DateTimeFormatter.ISO_OFFSET_DATE_TIME\n\ndef startEpoch = ZonedDateTime.parse(startDate, formatter).toInstant().toEpochMilli()\ndef endEpoch   = ZonedDateTime.parse(endDate, formatter).toInstant().toEpochMilli()\n\nreturn [\n    startEpoch: startEpoch,\n    endEpoch: endEpoch\n]\n",
				"parameters":{
					"endDate":"{{ n_iXkFJ.outputs.endDate }}",
					"startDate":"{{ n_iXkFJ.outputs.startDate }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"_4bJ2V",
			"index":26,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_e_traces=::=CREATED_TIME",
						"aggregationFunction":"HISTOGRAM",
						"alias":"time",
						"includePercentageChange":false,
						"intervals":[
							{
								"interval":"DAY",
								"groupBy":"DAY"
							},
							{
								"interval":"WEEK",
								"groupBy":"DAY"
							},
							{
								"interval":"MONTH",
								"groupBy":"DAY"
							},
							{
								"interval":"YEAR",
								"groupBy":"DAY"
							}
						]
					},
					{
						"name":"ENTITY_e_traces=::=userId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"dauCount",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"ENTITY_e_traces=::=fromAutomationId",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"ENTITY_e_traces",
				"includeTotalHits":true,
				"page":{
					"offset":0,
					"limit":5000
				},
				"sorts":[
					{
						"field":"time",
						"order":"ASC"
					}
				],
				"timeFilter":{
					"since":"{{ n_fsbnP.outputs.result.startEpoch }}",
					"until":"{{ n_fsbnP.outputs.result.endEpoch }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"n_0LROC",
			"index":27,
			"inputs":{
				"projections":[
					{
						"aggregationFunction":"HISTOGRAM",
						"includePercentageChange":false,
						"intervals":[],
						"name":"START_TIME",
						"alias":"time"
					},
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"USER_ID",
						"alias":"dauCount"
					}
				],
				"filter":{
					"filters":[
						{
							"property":"WORKFLOW_ID",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"WORKFLOW_EXECUTION",
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[
					{
						"field":"time",
						"order":"ASC"
					}
				],
				"timeFilter":{
					"until":"{{ n_fsbnP.outputs.result.endEpoch }}",
					"since":"{{ n_fsbnP.outputs.result.startEpoch }}"
				},
				"group":"PLATFORM"
			},
			"skip":true,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":103,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"n_ws6Lc",
			"index":28,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{
										"time":{
											"type":"integer",
											"title":"Time"
										},
										"mauCount":{
											"type":"integer",
											"title":"MauCount"
										},
										"dauCount":{
											"type":"integer",
											"title":"Dau Count"
										}
									},
									"required":[
										"time",
										"mauCount",
										"dauCount"
									]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"MAUandDAU",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"MAUandDAU",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"time":{
										"type":"integer",
										"title":"Time"
									},
									"mauCount":{
										"type":"integer",
										"title":"MauCount"
									},
									"dauCount":{
										"type":"integer",
										"title":"Dau Count"
									}
								},
								"required":[
									"time",
									"mauCount",
									"dauCount"
								]
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"MAUandDAU",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":102,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"n_womFq",
			"index":29,
			"inputs":{
				"repeatMode":"SINGLE",
				"listSource":"{{ _4bJ2V.outputs.objects }}",
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"For each loop",
			"type":"LOOP"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":103,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_womFq@n_knqDF@_vXQLK-1@4@l",
			"id":"n_AP7VQ",
			"index":30,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"startEpoch":{
							"type":"integer",
							"title":"Start Epoch"
						}
					},
					"additionalProperties":false,
					"required":[
						"startEpoch"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"endEpoch":{
							"type":"integer",
							"title":"End Epoch"
						}
					},
					"additionalProperties":false,
					"required":[
						"endEpoch"
					]
				},
				"compile_static":false,
				"code":"def endEpoch=binding.hasVariable(\"endEpoch\")?endEpoch as Long:0\n\nreturn [\"startEpoch\":endEpoch - (29 * 24 * 60 * 60 * 1000)]\n",
				"parameters":{
					"endEpoch":"{{ n_womFq.outputs.item.columns.time }}"
				}
			},
			"skip":false,
			"subTitle":"Get startTime",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_womFq@n_knqDF@_vXQLK-1@4@l",
			"id":"_M89KD",
			"index":31,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_e_traces=::=userId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"mauCount",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"ENTITY_e_traces=::=fromAutomationId",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"ENTITY_e_traces",
				"includeTotalHits":true,
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[
					{
						"field":"time",
						"order":"DESC"
					}
				],
				"timeFilter":{
					"since":"{{ n_AP7VQ.outputs.result.startEpoch }}",
					"until":"{{ n_womFq.outputs.item.columns.time }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_womFq@n_knqDF@_vXQLK-1@4@l",
			"id":"n_ZZMrM",
			"index":32,
			"inputs":{
				"itemToAdd":{
					"userCount":"{{ _RitcW.outputs.objects[0].columns.mauCount }}",
					"time":"{{ n_womFq.outputs.item.columns.time }}",
					"dauCount":"{{ n_womFq.outputs.item.columns.dauCount }}",
					"mauCount":"{{ _M89KD.outputs.objects[0].columns.mauCount }}"
				},
				"insertLocation":"END",
				"listName":"{{ n_ws6Lc.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_womFq@n_knqDF@_vXQLK-1@4@l",
			"id":"_RitcW",
			"index":33,
			"inputs":{
				"projections":[
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"USER_ID",
						"alias":"mauCount"
					}
				],
				"filter":{
					"filters":[
						{
							"property":"WORKFLOW_ID",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"WORKFLOW_EXECUTION",
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[
					{
						"field":"time",
						"order":"ASC"
					}
				],
				"timeFilter":{
					"since":"{{ n_AP7VQ.outputs.result.startEpoch }}",
					"until":"{{ n_womFq.outputs.item.columns.time }}"
				},
				"group":"PLATFORM"
			},
			"skip":true,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.mauAndDau.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":103,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@4",
			"id":"n_3iQkh",
			"index":34,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"mauAndDau":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"time":{
										"type":"integer",
										"title":"Time"
									},
									"dauCount":{
										"type":"integer",
										"title":"Dau Count"
									},
									"mauCount":{
										"type":"integer",
										"title":"Mau Count"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Mau And Dau"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"mauAndDau":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Mau And Dau"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"return [\"mauAndDau\":binding.hasVariable(\"mauAndDau\")?mauAndDau:[]]",
				"parameters":{
					"mauAndDau":{
						"source":"{{ n_ws6Lc.outputs.items }}",
						"ua:type":"mappedArray",
						"items":"{{ n_ws6Lc.outputs.items[0] }}"
					}
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false,
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"n_knqDF@5",
			"index":35,
			"inputs":{
				"name":"User Cost Analysis"
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"_2aKRT",
			"index":36,
			"inputs":{
				"projections":[
					{
						"name":"ENTITY_e_traces=::=userId",
						"aggregationFunction":"GROUP",
						"alias":"userId",
						"includePercentageChange":false
					},
					{
						"name":"ENTITY_e_traces=::=caseId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"totalSessions",
						"includePercentageChange":false
					},
					{
						"name":"ENTITY_e_traces=::=messageId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"totalQueries",
						"includePercentageChange":false
					},
					{
						"name":"ENTITY_e_traces=::=aiAgentId",
						"aggregationFunction":"DISTINCT_COUNT",
						"alias":"totalAgentsUsed",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"ENTITY_e_traces=::=fromAutomationId",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"ENTITY_e_traces",
				"includeTotalHits":true,
				"page":{
					"offset":0,
					"limit":1000
				},
				"sorts":[
					{
						"field":"totalSessions",
						"order":"DESC"
					}
				],
				"timeFilter":{
					"since":"{{ n_iXkFJ.outputs.startDate }}",
					"until":"{{ n_iXkFJ.outputs.endDate }}"
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"_k2kNM",
			"index":37,
			"inputs":{
				"projections":[
					{
						"aggregationFunction":"GROUP",
						"includePercentageChange":false,
						"name":"USER_ID",
						"alias":"userId"
					},
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"CASE_ID",
						"alias":"totalSessions"
					},
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"MESSAGE_ID",
						"alias":"totalQueries"
					},
					{
						"aggregationFunction":"DISTINCT_COUNT",
						"includePercentageChange":false,
						"name":"AI_AGENT_ID",
						"alias":"totalAgentsUsed"
					}
				],
				"filter":{
					"filters":[
						{
							"property":"WORKFLOW_ID",
							"filter":{
								"operator":"EQUAL",
								"value":"66966960e8797a59f4a46292"
							}
						},
						{
							"property":"USER_ID",
							"filter":{
								"operator":"REGEX",
								"value":"^[1-9][0-9]*$"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"WORKFLOW_EXECUTION",
				"includeTotalHits":true,
				"page":{
					"limit":1000,
					"offset":0
				},
				"sorts":[
					{
						"field":"totalSessions",
						"order":"DESC"
					}
				],
				"timeFilter":{
					"since":"{{ n_iXkFJ.outputs.startDate }}",
					"until":"{{ n_iXkFJ.outputs.endDate }}"
				},
				"group":"PLATFORM"
			},
			"skip":true,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"n_XSX6a",
			"index":38,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{}
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray",
					"source":"{{ _2aKRT.outputs.objects }}",
					"items":"{{ _2aKRT.outputs.objects[0].columns.userId }}"
				},
				"ua:title":"userIds",
				"ua:list_type":"STRING"
			},
			"outputSchema":{
				"type":"SCHEMA",
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"userIds",
							"disableActions":true,
							"items":{
								"type":"string"
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":103,
				"resourceName":"analytics_by_unifyapps_query_reports",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"n_JRXzG",
			"index":39,
			"inputs":{
				"projections":[
					{
						"name":"USER=::=custom_properties_role",
						"aggregationFunction":"GROUP",
						"alias":"role",
						"includePercentageChange":false
					},
					{
						"name":"USER=::=NAME",
						"aggregationFunction":"GROUP",
						"alias":"name",
						"includePercentageChange":false
					},
					{
						"name":"USER=::=USER_ID",
						"aggregationFunction":"GROUP",
						"alias":"id",
						"includePercentageChange":false
					}
				],
				"filter":{
					"filters":[
						{
							"property":"USER=::=USER_ID",
							"filter":{
								"operator":"IN",
								"value":"{{ n_XSX6a.outputs.items }}"
							}
						}
					],
					"operator":"AND"
				},
				"entityType":"USER",
				"page":{
					"offset":0,
					"limit":1000
				},
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Analytics Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":58,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"_tjY4N",
			"index":40,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"sqlQuery":{
							"type":"string",
							"title":"sqlQuery"
						}
					},
					"additionalProperties":false
				},
				"input":{
					"type":"object",
					"properties":{
						"limit":{
							"type":"integer",
							"title":"Limit"
						},
						"offset":{
							"type":"string",
							"title":"Offset"
						},
						"timestampStart":{
							"type":"string",
							"title":"Timestamp Start"
						},
						"timestampEnd":{
							"type":"string",
							"title":"Timestamp End"
						},
						"userIds":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"User Ids"
						}
					},
					"additionalProperties":false,
					"required":[
						"userIds"
					]
				},
				"compile_static":false,
				"code":"\nimport java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\n\ndef toSqlInClauseFormat(List<String> items) {\n    if (!items) return '()'\n    def quoted = items.collect { '\"' + it + '\"' }\n    return '(' + quoted.join(', ') + ')'\n}\n\ndef getEpochMillis(String timestamp) {\n    def zdt = ZonedDateTime.parse(timestamp, DateTimeFormatter.ISO_DATE_TIME)\n    return zdt.toInstant().toEpochMilli()\n}\n\ndef generateQuery(startTime, endTime, userIds) {\n    def userIdClause = toSqlInClauseFormat(userIds)\n\n    def query = new StringBuilder()\n    query.append('SELECT \\n')\n    query.append('    _pr_userId AS UserID,\\n')\n    query.append('    SUM(COALESCE(CAST(_pr_cost AS FLOAT), 0.0)) AS TotalCost,\\n')\n    query.append('    (\\n')\n    query.append('        SUM(COALESCE(CAST(_pr_inputToken AS INT), 0)) +\\n')\n    query.append('        SUM(COALESCE(CAST(_pr_outputToken AS INT), 0))\\n')\n    query.append('    ) AS TotalTokens\\n')\n    query.append('FROM ENTITY_e_traces wne\\n')\n    query.append('WHERE\\n')\n    query.append('    createdTime BETWEEN ').append(startTime).append(' AND ').append(endTime).append('\\n')\n    query.append('    AND _pr_fromAutomationId = \\'66ac70650f725f5b425d12d8\\'\\n')\n    query.append('    AND  _pr_userId IN ').append(userIdClause).append('\\n')\n    query.append('GROUP BY _pr_userId\\n')\n    query.append('ORDER BY TotalCost DESC\\n')\n    query.append('LIMIT 20 OFFSET 0;')\n\n    return query.toString()\n}\n\ndef startTime = getEpochMillis(timestampStart)\ndef endTime = getEpochMillis(timestampEnd)\n\ndef sqlQuery = generateQuery(startTime, endTime, userIds)\nreturn [sqlQuery: sqlQuery]\n",
				"isAsync":false,
				"parameters":{
					"offset":"0",
					"limit":1000,
					"timestampStart":"{{ n_iXkFJ.outputs.startDate }}",
					"timestampEnd":"{{ n_iXkFJ.outputs.endDate }}",
					"userIds":{
						"ua:type":"mappedArray",
						"source":"{{ n_XSX6a.outputs.items }}",
						"items":"{{ n_XSX6a.outputs.items[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Generate SQL",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":18,
				"resourceName":"analytics_by_unifyapps_execute_query",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"_seAjO",
			"index":41,
			"inputs":{
				"outputSchema":{
					"type":"object",
					"properties":{
						"columns":{
							"type":"object",
							"properties":{
								"TotalTokens":{
									"type":"string",
									"title":"Total Tokens"
								},
								"TotalCost":{
									"type":"number",
									"title":"Total Cost"
								},
								"UserID":{
									"type":"string",
									"title":"User ID"
								}
							},
							"title":"columns",
							"additionalProperties":false,
							"required":[
								"TotalTokens",
								"UserID"
							]
						}
					},
					"additionalProperties":false
				},
				"query":"{{ _tjY4N.outputs.result.sqlQuery }}",
				"group":"PLATFORM"
			},
			"skip":false,
			"subTitle":"Execute SQL",
			"title":"Execute Analytics SQL Query",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				},
				"visibleOptionalFields":[
					"root.parameters.costAnalysis.items.totalSessions",
					"root.parameters.costAnalysis.items.totalQueries",
					"root.parameters.costAnalysis.items.userId",
					"root.parameters.costAnalysis.items.totalAgentsUsed"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@5",
			"id":"n_nx4j5",
			"index":42,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"result":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"totalSessions":{
										"type":"integer",
										"title":"totalSessions"
									},
									"totalQueries":{
										"type":"integer",
										"title":"totalQueries"
									},
									"totalAgentsUsed":{
										"type":"integer",
										"title":"totalAgentsUsed"
									},
									"role":{
										"type":"string",
										"title":"Role"
									},
									"name":{
										"type":"string",
										"title":"Name"
									},
									"totalCost":{
										"type":"number",
										"title":"Total Cost"
									},
									"totalTokens":{
										"type":"integer",
										"title":"Total Tokens"
									},
									"totalCostPerSession":{
										"type":"number",
										"title":"Total Cost Per Session"
									}
								},
								"additionalProperties":false,
								"required":[
									"role",
									"totalCost",
									"totalTokens",
									"totalCostPerSession"
								]
							},
							"title":"result"
						},
						"pagenation":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Pagenation"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"costAnalysis":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"totalSessions":{
										"type":"integer",
										"title":"totalSessions"
									},
									"totalQueries":{
										"type":"integer",
										"title":"totalQueries"
									},
									"userId":{
										"type":"string",
										"title":"userId"
									},
									"totalAgentsUsed":{
										"type":"integer",
										"title":"totalAgentsUsed"
									}
								},
								"additionalProperties":false
							},
							"title":"costAnalysis"
						},
						"users":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"id":{
										"type":"string",
										"title":"Id"
									},
									"name":{
										"type":"string",
										"title":"Name"
									},
									"role":{
										"type":"string",
										"title":"Role"
									}
								},
								"additionalProperties":false,
								"required":[
									"id",
									"name",
									"role"
								]
							},
							"title":"Users"
						},
						"tokenAnalysis":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"userId":{
										"type":"string",
										"title":"User Id"
									},
									"totalCost":{
										"type":"number",
										"title":"Total Cost"
									},
									"totalTokens":{
										"type":"string",
										"title":"Total Tokens"
									}
								},
								"additionalProperties":false,
								"required":[
									"userId",
									"totalCost",
									"totalTokens"
								]
							},
							"title":"Token Analysis"
						},
						"limit":{
							"type":"integer",
							"title":"Limit"
						},
						"offset":{
							"type":"integer",
							"title":"Offset"
						}
					},
					"additionalProperties":false,
					"required":[
						"users",
						"tokenAnalysis",
						"limit",
						"offset"
					]
				},
				"compile_static":false,
				"code":"def enrichCostAnalysis(users, costAnalysis, tokenAnalysis,limit,offset) {\n    // Build lookup maps\n    def userMap = users.collectEntries { user ->\n        [(user.id.toString()): [name: user.name, role: user.role?.trim() ? user.role : \"Product Analyst\"]]\n    }\n\n    def tokenMap = tokenAnalysis.collectEntries { token ->\n        [(token.userId.toString()): [\n            totalCost: token.totalCost,\n            totalTokens: token.totalTokens\n        ]]\n    }\n\n    // Filter and enrich costAnalysis entries\n    def result = costAnalysis.findAll { entry ->\n        def user = userMap[entry.userId.toString()]\n        return user && user.name?.trim()\n    }.collect { entry ->\n        def userInfo = userMap[entry.userId.toString()] ?: [:]\n        def tokenInfo = tokenMap[entry.userId.toString()] ?: [:]\n\n        def totalCost = ((tokenInfo.totalCost ?: 0) as BigDecimal).setScale(3, BigDecimal.ROUND_HALF_UP)\n        def totalSessions = (entry.totalSessions ?: 0) as BigDecimal\n\n        def totalCostPerSession = totalSessions > 0 ? (totalCost / totalSessions).setScale(2, BigDecimal.ROUND_HALF_UP) : 0\n\n        return entry + userInfo + tokenInfo + [totalCost: totalCost, totalCostPerSession: totalCostPerSession]\n    }\n    result = result.sort { it.name?.toLowerCase() }\n\n    def paginatedResult = result.drop(offset).take(limit)\n\n    return [result: paginatedResult]\n}\ndef limit=binding.hasVariable(\"limit\")?limit:10\ndef offset=binding.hasVariable(\"offset\")?offset:0\nreturn enrichCostAnalysis(users, costAnalysis, tokenAnalysis,limit,offset)\n",
				"parameters":{
					"costAnalysis":{
						"ua:type":"mappedArray",
						"items":{
							"totalSessions":"{{ _2aKRT.outputs.objects[0].columns.totalSessions }}",
							"totalQueries":"{{ _2aKRT.outputs.objects[0].columns.totalQueries }}",
							"userId":"{{ _2aKRT.outputs.objects[0].columns.userId }}",
							"totalAgentsUsed":"{{ _2aKRT.outputs.objects[0].columns.totalAgentsUsed }}"
						},
						"source":"{{ _2aKRT.outputs.objects }}"
					},
					"users":{
						"ua:type":"mappedArray",
						"items":{
							"id":"{{ n_JRXzG.outputs.objects[0].columns.id }}",
							"name":"{{ n_JRXzG.outputs.objects[0].columns.name }}",
							"role":"{{ n_JRXzG.outputs.objects[0].columns.role }}"
						},
						"source":"{{ n_JRXzG.outputs.objects }}"
					},
					"tokenAnalysis":{
						"source":"{{ _seAjO.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"userId":"{{ _seAjO.outputs.objects[0].columns.UserID }}",
							"totalCost":"{{ _seAjO.outputs.objects[0].columns.TotalCost }}",
							"totalTokens":"{{ _seAjO.outputs.objects[0].columns.TotalTokens }}"
						}
					},
					"limit":"{{ n_iXkFJ.outputs.limit }}",
					"offset":"{{ n_iXkFJ.outputs.offset }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@6",
			"id":"n_knqDF@6",
			"index":43,
			"inputs":{
				"name":"Usage Trend"
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":102,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@6",
			"id":"_YmSVh",
			"index":44,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"sqlQuery"
					],
					"properties":{
						"sqlQuery":{
							"type":"string",
							"title":"Sql Query"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"startDate",
						"endDate"
					],
					"properties":{
						"startDate":{
							"type":"string",
							"title":"Start Date"
						},
						"endDate":{
							"type":"string",
							"title":"End Date"
						}
					}
				},
				"code":"import java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\n\ndef formatter = DateTimeFormatter.ISO_OFFSET_DATE_TIME\n\ndef startEpoch = ZonedDateTime.parse(startDate, formatter).toInstant().toEpochMilli()\ndef endEpoch   = ZonedDateTime.parse(endDate, formatter).toInstant().toEpochMilli()\n\ndef generateSQL(startEpoch, endEpoch) {\n    def regexPattern = \"'^[1-9][0-9]*\\$'\"\n    return \"\"\"\n        SELECT DATE_FORMAT(FROM_UNIXTIME(CAST(createdTime / 1000 AS BIGINT)), '%Y-%m-%d %H:00:00') AS hour_bucket,\n               COUNT(DISTINCT _pr_userId) AS active_users\n        FROM ENTITY_e_traces\n        WHERE _pr_fromAutomationId = '66966960e8797a59f4a46292'\n          AND createdTime >= ${startEpoch}\n          AND createdTime <= ${endEpoch}\n          AND regexp(CAST(_pr_userId AS STRING), ${regexPattern})\n        GROUP BY hour_bucket\n        ORDER BY hour_bucket ASC\n    \"\"\".toString()\n}\n\nreturn [\n    sqlQuery: generateSQL(startEpoch, endEpoch)\n]",
				"compile_static":false,
				"parameters":{
					"startDate":"{{ n_iXkFJ.outputs.startDate }}",
					"endDate":"{{ n_iXkFJ.outputs.endDate }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":104,
				"resourceName":"analytics_by_unifyapps_execute_query",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@6",
			"id":"n_71NyR",
			"index":45,
			"inputs":{
				"outputSchema":{
					"type":"object",
					"properties":{
						"columns":{
							"type":"object",
							"properties":{
								"hour_bucket":{
									"type":"string",
									"title":"Hour Bucket"
								},
								"active_users":{
									"type":"integer",
									"title":"Active Users"
								}
							},
							"additionalProperties":false,
							"title":"Columns",
							"required":[
								"hour_bucket",
								"active_users"
							]
						}
					},
					"additionalProperties":false,
					"required":[
						"columns"
					]
				},
				"query":"{{ _YmSVh.outputs.result.sqlQuery }}",
				"group":"PLATFORM"
			},
			"skip":false,
			"subTitle":"Analytics by UnifyApps",
			"title":"Execute Analytics SQL Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":103,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@6",
			"id":"n_i5FEn",
			"index":46,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"finalUserTrend":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"active_users":{
										"type":"integer",
										"title":"Active Users"
									},
									"hour_bucket":{
										"type":"string",
										"title":"Hour Bucket"
									}
								},
								"additionalProperties":false,
								"required":[
									"active_users",
									"hour_bucket"
								]
							},
							"title":"Final User Trend"
						},
						"peakUser":{
							"type":"integer",
							"title":"Peak User"
						},
						"peakRange":{
							"type":"string",
							"title":"Peak Range"
						}
					},
					"additionalProperties":false,
					"required":[
						"finalUserTrend"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"userTrendData":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"hour_bucket":{
										"type":"string",
										"title":"Hour Bucket"
									},
									"active_users":{
										"type":"integer",
										"title":"Active Users"
									}
								},
								"additionalProperties":false,
								"required":[
									"hour_bucket",
									"active_users"
								]
							},
							"title":"User Trend Data"
						}
					},
					"additionalProperties":false,
					"required":[
						"userTrendData"
					]
				},
				"compile_static":false,
				"code":"import java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\n\ndef userTrendData = binding.hasVariable(\"userTrendData\") ? binding.userTrendData : []\ndef formatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")\n\n// Group by hour of day (ignore day)\ndef grouped = userTrendData.groupBy { row ->\n    def ldt = LocalDateTime.parse(row.hour_bucket, formatter)\n    return ldt.getHour()\n}\n\n// Build final structure: 023 hours\ndef finalUserTrend = (0..23).collect { hour ->\n    def rows = grouped[hour] ?: []\n    def avg = rows ? (rows*.active_users.sum() / rows.size()) : 0\n    [\n        hour_bucket: String.format(\"%02d:00\", hour),\n        active_users: (int) avg  // truncate to integer\n    ]\n}\n\ndef peakBucket = finalUserTrend.max { it.active_users }\ndef peakHour = Integer.parseInt(peakBucket.hour_bucket.split(\":\")[0])\ndef peakRange = String.format(\"%02d-%02d\", peakHour, (peakHour + 1) % 24)\n\nreturn [\"finalUserTrend\": finalUserTrend,\"peakRange\":peakRange,\"peakUser\":peakBucket.active_users]",
				"parameters":{
					"userTrendData":{
						"source":"{{ n_71NyR.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"hour_bucket":"{{ n_71NyR.outputs.objects[0].columns.hour_bucket }}",
							"active_users":"{{ n_71NyR.outputs.objects[0].columns.active_users }}"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Avg of all days for each Hour",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@7",
			"id":"n_knqDF@7",
			"index":47,
			"inputs":{
				"name":"Fav Topics"
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":58,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@7",
			"id":"_prtKB",
			"index":48,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"sqlQuery":{
							"type":"string",
							"title":"sqlQuery"
						}
					},
					"additionalProperties":false
				},
				"input":{
					"type":"object",
					"properties":{
						"timestampStart":{
							"type":"string",
							"title":"Timestamp Start"
						},
						"timestampEnd":{
							"type":"string",
							"title":"Timestamp End"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"import java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\n\ndef getEpochMillis(String timestamp) {\n    def zdt = ZonedDateTime.parse(timestamp, DateTimeFormatter.ISO_DATE_TIME)\n    return zdt.toInstant().toEpochMilli()\n}\n\ndef generateQuery(startTime, endTime) {\n    def query = new StringBuilder()\n    query.append('SELECT \\n')\n    query.append(\"    CAST(_pr_topicName AS STRING) AS topicName,\\n\")\n    query.append(\"    COUNT(*) AS topicCount\\n\")\n    query.append(\"FROM ENTITY_e_traces \\n\")\n    query.append(\"WHERE\\n\")\n    query.append(\"    createdTime BETWEEN \").append(startTime).append(\" AND \").append(endTime).append(\"\\n\")\n    query.append(\"    AND _pr_fromAutomationId = '6794860f9c8ab5620dca97a5'\\n\")\n    query.append(\"GROUP BY topicName\\n\")\n    query.append(\"ORDER BY topicCount DESC\\n\")\n    query.append(\"LIMIT 5 OFFSET 0;\")\n\n    return query.toString()\n}\n\n// Replace these with actual ISO date strings like \"2025-08-01T00:00:00Z\"\ndef startTime = getEpochMillis(timestampStart)\ndef endTime = getEpochMillis(timestampEnd)\n\ndef sqlQuery = generateQuery(startTime, endTime)\nreturn [sqlQuery: sqlQuery]\n",
				"isAsync":false,
				"parameters":{
					"timestampStart":"{{ n_iXkFJ.outputs.startDate }}",
					"timestampEnd":"{{ n_iXkFJ.outputs.endDate }}"
				}
			},
			"skip":false,
			"subTitle":"Generate SQL",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"analytics_by_unifyapps",
				"resourceVersion":18,
				"resourceName":"analytics_by_unifyapps_execute_query",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_knqDF@_vXQLK-1@7",
			"id":"_LXfNh",
			"index":49,
			"inputs":{
				"outputSchema":{
					"type":"object",
					"properties":{
						"columns":{
							"type":"object",
							"properties":{
								"topicName":{
									"type":"string",
									"title":"Topic Name"
								},
								"topicCount":{
									"type":"integer",
									"title":"Topic Count"
								}
							},
							"title":"columns",
							"additionalProperties":false,
							"required":[
								"topicName",
								"topicCount"
							]
						}
					},
					"additionalProperties":false
				},
				"query":"{{ _prtKB.outputs.result.sqlQuery }}",
				"group":"PLATFORM"
			},
			"skip":false,
			"subTitle":"Execute SQL",
			"title":"Execute Analytics SQL Query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":103,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_vXQLK-1",
			"id":"n_ZPgAK",
			"index":50,
			"inputs":{
				"result":{
					"meteringResult":{
						"weeklyActiveUsers":"{{ n_7ApTh.outputs.result.weeklyActiveUsers }}",
						"userRetention":"{{ n_7ApTh.outputs.result.userRetention }}",
						"averageSessionDuration":"{{ _J2puU.outputs.result.result }}",
						"totalUsers":"{{ _62oxO.outputs.total }}",
						"userCostAnalysis":{
							"ua:type":"mappedArray",
							"items":{
								"totalCost":"{{ n_nx4j5.outputs.result.result[0].totalCost }}",
								"totalQueries":"{{ n_nx4j5.outputs.result.result[0].totalQueries }}",
								"totalSessions":"{{ n_nx4j5.outputs.result.result[0].totalSessions }}",
								"totalAgents":"{{ n_nx4j5.outputs.result.result[0].totalAgentsUsed }}",
								"name":"{{ n_nx4j5.outputs.result.result[0].name }}",
								"role":"{{ n_nx4j5.outputs.result.result[0].role }}",
								"totalTokens":"{{ n_nx4j5.outputs.result.result[0].totalTokens }}",
								"costPerSession":"{{ n_nx4j5.outputs.result.result[0].totalCostPerSession }}"
							},
							"source":"{{ n_nx4j5.outputs.result.result }}"
						},
						"activeUsersTrend":{
							"ua:type":"mappedArray",
							"items":{
								"timestamp":"{{ n_3iQkh.outputs.result.mauAndDau[0].time }}",
								"dau":"{{ n_3iQkh.outputs.result.mauAndDau[0].dauCount }}",
								"mau":"{{ n_3iQkh.outputs.result.mauAndDau[0].mauCount }}"
							},
							"source":"{{ n_3iQkh.outputs.result.mauAndDau }}"
						},
						"usageTrend":{
							"ua:type":"mappedArray",
							"items":{
								"timestamp":"{{ n_i5FEn.outputs.result.finalUserTrend[0].hour_bucket }}",
								"avgUserCount":"{{ n_i5FEn.outputs.result.finalUserTrend[0].active_users }}"
							},
							"source":"{{ n_i5FEn.outputs.result.finalUserTrend }}"
						},
						"sessionPerUserDistribution":{
							"ua:type":"mappedArray",
							"items":{
								"bucket":"{{ _ptr2s.outputs.result.result[0].bucket }}",
								"count":"{{ _ptr2s.outputs.result.result[0].count }}"
							},
							"source":"{{ _ptr2s.outputs.result.result }}"
						},
						"topTopics":{
							"source":"{{ _LXfNh.outputs.objects }}",
							"ua:type":"mappedArray",
							"items":{
								"topicName":"{{ _LXfNh.outputs.objects[0].columns.topicName }}",
								"count":"{{ _LXfNh.outputs.objects[0].columns.topicCount }}"
							}
						},
						"totalUsersCount":"{{ _k2kNM.outputs.total }}",
						"peakRange":"{{ n_i5FEn.outputs.result.peakRange }}",
						"peak_users":"{{ n_i5FEn.outputs.result.peakUser }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":-1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		
	],
	"version":67
}