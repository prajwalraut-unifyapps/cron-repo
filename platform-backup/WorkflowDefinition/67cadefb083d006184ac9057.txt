{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1747000727828,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1759312640897,
		"deployedBy":0,
		"deployedDefinitionId":"68dcfb001edc480c9a44f7ba",
		"status":"DEPLOYED",
		"version":81,
		"workflowVersion":98
	},
	"edges":[
		{
			"fromNodeId":"1FSb6",
			"priority":0,
			"skip":false,
			"toNodeId":"3ruoW",
			"type":"next"
		},
		{
			"fromNodeId":"3ruoW",
			"priority":0,
			"skip":false,
			"toNodeId":"byKms",
			"type":"next"
		},
		{
			"fromNodeId":"byKms",
			"priority":0,
			"skip":false,
			"toNodeId":"aFA5A",
			"type":"next"
		},
		{
			"fromNodeId":"aFA5A",
			"priority":0,
			"skip":false,
			"toNodeId":"n_czneK",
			"type":"next"
		},
		{
			"fromNodeId":"n_czneK",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_xycc4",
			"type":"if"
		},
		{
			"fromNodeId":"n_xycc4",
			"priority":0,
			"skip":false,
			"toNodeId":"Xvcu5",
			"type":"next"
		},
		{
			"fromNodeId":"n_czneK",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"Xvcu5",
			"type":"next"
		},
		{
			"fromNodeId":"Xvcu5",
			"priority":0,
			"skip":false,
			"toNodeId":"HSW2U",
			"type":"next"
		},
		{
			"fromNodeId":"HSW2U",
			"priority":0,
			"skip":false,
			"toNodeId":"s3oiL",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"67cadefb083d006184ac9057",
	"lastModifiedBy":1,
	"lcName":"fetch recent accessed ai agents",
	"modifiedTime":1759323985630,
	"name":"Fetch Recent Accessed AI Agents",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":119,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"1FSb6",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"aiAgentIds":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"agent":{
										"type":"object",
										"properties":{
											"agentId":{
												"type":"string",
												"title":"Agent Id"
											},
											"agentIcon":{
												"type":"string",
												"title":"Agent Icon"
											},
											"agentName":{
												"type":"string",
												"title":"Agent Name"
											},
											"agentType":{
												"type":"string",
												"title":"Agent Type"
											},
											"currentUserPermissions":{
												"type":"array",
												"items":{
													"type":"string"
												},
												"title":"Current User Permissions"
											}
										},
										"additionalProperties":false,
										"title":"Agent",
										"required":[
											"agentId",
											"agentIcon",
											"agentName"
										]
									}
								},
								"additionalProperties":false,
								"required":[
									"agent"
								]
							},
							"title":"Ai Agent Ids"
						},
						"success":{
							"type":"boolean",
							"title":"Success"
						}
					}
				},
				"setup":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"copilotType":{
							"type":"string",
							"title":"Copilot Type"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":114,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"3ruoW",
			"index":2,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"ui:submitButtonOptions":{
						"norender":true
					}
				},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"userIdWithCoPilot":{
							"type":"string",
							"title":"User Id With Co Pilot"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"userIdWithCoPilot":"{{ __RUN__.outputs.userId }}#{{ 1FSb6.outputs.copilotType }}"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"userIdWithCoPilot":{
							"type":"string",
							"title":"User Id With Co Pilot"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"userIdWithCoPilot",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":2041,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"byKms",
			"index":3,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_channelSpecificId",
							"filter":{
								"operator":"CONTAINS",
								"value":"{{ 3ruoW.outputs.userIdWithCoPilot }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"customer_profile",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"mTm",
						"order":"DESC"
					}
				],
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":5,
					"offset":0
				},
				"numberOfRecordsToFetch":"MULTIPLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.channelSpecificUserIds.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":119,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"aFA5A",
			"index":4,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"aiAgentIds":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Ai Agent Ids"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"channelSpecificUserIds":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Channel Specific User Ids"
						}
					}
				},
				"code":"def aiAgentIds = []\nif (!binding.hasVariable(\"channelSpecificUserIds\")){\n  return [:]\n}\nfor(userIdWithCopilot in channelSpecificUserIds) {\n  def variables = userIdWithCopilot.split(\"#\")\nif(variables.size() > 2){\n aiAgentIds.add(userIdWithCopilot.split(\"#\").getAt(2))\n}\n}\n\nreturn [\"aiAgentIds\": aiAgentIds]",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{
					"channelSpecificUserIds":{
						"source":"{{ byKms.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":"{{ byKms.outputs.objects[0].properties.channelSpecificId }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":437,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"n_czneK",
			"index":5,
			"inputs":{
				"filters":[
					{
						"property":"=LEN({{ aFA5A.outputs.result.aiAgentIds }})",
						"filter":{
							"operator":"EQUAL",
							"value":"0"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Empty agent list ",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":454,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_czneK@ARRYh-1@y",
			"id":"n_xycc4",
			"index":6,
			"inputs":{
				"result":{
					"success":true
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":2374,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"Xvcu5",
			"index":7,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"id",
							"filter":{
								"operator":"IN",
								"value":"{{ aFA5A.outputs.result.aiAgentIds }}"
							}
						},
						{
							"property":"properties_name",
							"filter":{
								"operator":"EXISTS"
							}
						},
						{
							"property":"properties_deployedOn",
							"filter":{
								"operator":"IN",
								"value":"unify_ai"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"ai_agent",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":true,
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":20
				},
				"numberOfRecordsToFetch":"MULTIPLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.agentList.items.agent.agentId",
					"root.parameters.agentList.items.agent.agentIcon",
					"root.parameters.agentList.items.agent.agentName",
					"root.parameters.inputOrder.items",
					"root.parameters.agentList.items.agent.currentUserPermissions.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":135,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"HSW2U",
			"index":8,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"finalAgents"
					],
					"properties":{
						"finalAgents":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"agent":{
										"type":"object",
										"properties":{
											"agentId":{
												"type":"string",
												"title":"Agent Id"
											},
											"agentIcon":{
												"type":"string",
												"title":"Agent Icon"
											},
											"agentName":{
												"type":"string",
												"title":"Agent Name"
											},
											"agentType":{
												"type":"string",
												"title":"Agent Type"
											},
											"currentUserPermissions":{
												"type":"array",
												"items":{
													"type":"string"
												},
												"title":"Current User Permissions"
											}
										},
										"additionalProperties":false,
										"title":"Agent",
										"required":[
											"agentId",
											"agentIcon",
											"agentName",
											"agentType"
										]
									}
								},
								"additionalProperties":false,
								"required":[
									"agent"
								]
							},
							"title":"Final Agents"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"properties":{
						"agentList":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"agent":{
										"type":"object",
										"properties":{
											"agentId":{
												"type":"string",
												"title":"agentId"
											},
											"agentIcon":{
												"type":"string",
												"title":"agentIcon"
											},
											"agentName":{
												"type":"string",
												"title":"agentName"
											},
											"agentType":{
												"type":"string",
												"title":"agentType"
											},
											"currentUserPermissions":{
												"type":"array",
												"items":{
													"type":"string"
												},
												"title":"Current User Permissions"
											}
										},
										"title":"agent",
										"additionalProperties":false,
										"required":[
											"agentType"
										]
									}
								},
								"additionalProperties":false
							},
							"title":"agentList"
						},
						"inputOrder":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"inputOrder"
						}
					}
				},
				"code":"if (!binding.hasVariable(\"agentList\")){\n    return [:]\n}\n\ndef sortedAgents = agentList.findAll { item -> \n    inputOrder.contains(item.agent.agentId) \n}.sort { a, b -> \n    inputOrder.indexOf(a.agent.agentId) <=> inputOrder.indexOf(b.agent.agentId)\n}\ndef top3Agents = sortedAgents.take(3)\nreturn [\"finalAgents\":top3Agents]",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{
					"agentList":{
						"source":"{{ Xvcu5.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"agent":{
								"agentId":"{{ Xvcu5.outputs.objects[0].id }}",
								"agentIcon":"{{ Xvcu5.outputs.objects[0].properties.avatarUrl }}",
								"agentName":"{{ Xvcu5.outputs.objects[0].properties.name }}",
								"agentType":"{{ Xvcu5.outputs.objects[0].properties.agentType }}",
								"currentUserPermissions":{
									"source":"{{ Xvcu5.outputs.objects[0].currentUserPermissions }}",
									"ua:type":"mappedArray",
									"items":"{{ Xvcu5.outputs.objects[0].currentUserPermissions[0] }}"
								}
							}
						}
					},
					"inputOrder":{
						"source":"{{ aFA5A.outputs.result.aiAgentIds }}",
						"ua:type":"mappedArray",
						"items":"{{ aFA5A.outputs.result.aiAgentIds }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":121,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ARRYh-1",
			"id":"s3oiL",
			"index":9,
			"inputs":{
				"result":{
					"success":true,
					"aiAgentIds":{
						"ua:type":"mappedArray",
						"items":{
							"agent":{
								"agentId":"{{ HSW2U.outputs.result.finalAgents[0].agent.agentId }}",
								"agentIcon":"{{ HSW2U.outputs.result.finalAgents[0].agent.agentIcon }}",
								"agentName":"{{ HSW2U.outputs.result.finalAgents[0].agent.agentName }}",
								"agentType":"{{ HSW2U.outputs.result.finalAgents[0].agent.agentType }}",
								"currentUserPermissions":{
									"source":"{{ HSW2U.outputs.result.finalAgents[0].agent.currentUserPermissions }}",
									"ua:type":"mappedArray"
								}
							}
						},
						"source":"{{ HSW2U.outputs.result.finalAgents }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":false,
		"enableRunLogging":false,
		"enableVariableLogging":false,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent"
	],
	"version":99
}