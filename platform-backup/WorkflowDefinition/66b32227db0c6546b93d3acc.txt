{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1747000721236,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1758796414461,
		"deployedBy":1,
		"deployedDefinitionId":"68d51a7ed7e8855348a8793d",
		"status":"DEPLOYED",
		"version":71,
		"workflowVersion":126
	},
	"edges":[
		{
			"fromNodeId":"ZaGfO",
			"priority":0,
			"skip":false,
			"toNodeId":"AM1KE",
			"type":"next"
		},
		{
			"fromNodeId":"AM1KE",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"QOqo0",
			"type":"if"
		},
		{
			"fromNodeId":"QOqo0",
			"priority":0,
			"skip":false,
			"toNodeId":"OXFuq",
			"type":"next"
		},
		{
			"fromNodeId":"OXFuq",
			"priority":0,
			"skip":false,
			"toNodeId":"t4nNA",
			"type":"next"
		},
		{
			"fromNodeId":"AM1KE",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"t4nNA",
			"type":"next"
		},
		{
			"fromNodeId":"t4nNA",
			"priority":0,
			"skip":false,
			"toNodeId":"U3IHx",
			"type":"next"
		},
		{
			"fromNodeId":"U3IHx",
			"priority":0,
			"skip":false,
			"toNodeId":"1LRFg",
			"type":"next"
		},
		{
			"fromNodeId":"1LRFg",
			"priority":0,
			"skip":false,
			"toNodeId":"d40Bw",
			"type":"next"
		},
		{
			"fromNodeId":"d40Bw",
			"priority":0,
			"skip":false,
			"toNodeId":"b66uk",
			"type":"next"
		},
		{
			"fromNodeId":"b66uk",
			"priority":0,
			"skip":false,
			"toNodeId":"_CqcoE",
			"type":"next"
		},
		{
			"fromNodeId":"_CqcoE",
			"priority":0,
			"skip":false,
			"toNodeId":"KszV6",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"66b32227db0c6546b93d3acc",
	"lastModifiedBy":-1,
	"lcName":"custom word filter (ai agent)",
	"modifiedTime":1758820924994,
	"name":"Custom Word Filter (AI Agent)",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":46,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"ZaGfO",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"filtered_answer":{
							"type":"string",
							"title":"filtered_answer"
						},
						"block":{
							"type":"boolean",
							"title":"block",
							"default":false
						}
					},
					"additionalProperties":false,
					"required":[],
					"dynamic":true
				},
				"setup":{
					"type":"object",
					"properties":{
						"answer":{
							"type":"string",
							"title":"answer"
						},
						"wordsOrPhrases":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"name":{
										"type":"string",
										"title":"name"
									}
								},
								"additionalProperties":false
							},
							"title":"wordsOrPhrases",
							"required":[]
						},
						"filterProfanity":{
							"type":"boolean",
							"title":"filterProfanity",
							"default":false
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger from automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":47,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"AM1KE",
			"index":2,
			"inputs":{
				"filters":[
					{
						"property":"=LEN({{ ZaGfO.outputs.wordsOrPhrases }})",
						"filter":{
							"operator":"EQUAL",
							"value":"0"
						}
					},
					{
						"property":"{{ ZaGfO.outputs.wordsOrPhrases[0].name }}",
						"filter":{
							"operator":"MISSING"
						}
					}
				],
				"operator":"OR"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":45,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"AM1KE@Dc7oH-1@y",
			"id":"QOqo0",
			"index":3,
			"inputs":{
				"result":{
					"block":false,
					"filtered_answer":"{{ ZaGfO.outputs.answer }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"stop"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"AM1KE@Dc7oH-1@y",
			"id":"OXFuq",
			"index":4,
			"skip":false,
			"subTitle":"Stop",
			"title":"Stop",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":300,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"t4nNA",
			"index":5,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"now":{
							"type":"integer",
							"title":"Now"
						}
					},
					"additionalProperties":false,
					"required":[
						"now"
					]
				},
				"compile_static":false,
				"code":"return ['now': System.currentTimeMillis()]"
			},
			"skip":false,
			"subTitle":"startTime",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":299,
				"resourceName":"variable_by_unifyapps_get_session_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"U3IHx",
			"index":6,
			"inputs":{
				"variableSchema":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"messageId":{
							"type":"string",
							"title":"Message Id"
						},
						"aiAgentId":{
							"type":"string",
							"title":"Ai Agent Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable",
			"title":"Get Session Variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":2,
				"resourceName":"storage_by_unifyapps_get_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"1LRFg",
			"index":7,
			"inputs":{
				"object_type":"profanity_list",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"id":"e_66b34b7bfa9498057c971711",
				"readThroughSessionVariables":true
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch record by ID",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.wordsOrPhrases.items",
					"root.parameters.profanityList.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":52,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"d40Bw",
			"index":8,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"filtered_answer":{
							"type":"string",
							"title":"filtered_answer"
						},
						"block":{
							"type":"boolean",
							"title":"block",
							"default":false
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"wordsOrPhrases":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"wordsOrPhrases"
						},
						"filterProfanity":{
							"type":"boolean",
							"title":"filterProfanity"
						},
						"answer":{
							"type":"string",
							"title":"answer"
						},
						"profanityList":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"profanityList"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"// import java.util.regex.Pattern\n\n// // Function to process the answer string based on wordsOrPhrases\n// def processAnswer(String answer, List wordsOrPhrases) {\n//     def block = false\n//     def originalAnswer = answer\n\n//     wordsOrPhrases.each { wordOrPhrase ->\n//         def pattern = \"(?i)\" + Pattern.quote(wordOrPhrase.name)\n//         def nanswer = answer.replaceAll(pattern, \"\")\n//         if (nanswer != answer) {\n//             block = true\n//             return [\"filtered_answer\": originalAnswer, \"block\": block]\n//         }\n//         answer = nanswer\n//     }\n\n//     // if (filterProfanity == true && binding.hasVariable('profanityList')) {\n//     //     profanityList.each { profanity ->\n//     //         def pattern = \"(?i)\" + Pattern.quote(profanity)\n//     //         def nanswer = answer.replaceAll(pattern, \"\")\n//     //         if (nanswer != answer) {\n//     //             block = true\n//     //             return [\"filtered_answer\": originalAnswer, \"block\": block]\n//     //         }\n//     //         answer = nanswer\n//     //     }\n//     // }\n\n//     return [\"filtered_answer\": answer, \"block\": false]\n// }\n\n// // Process the answer with the given words or phrases\n// return processAnswer(answer, wordsOrPhrases)\n\n\n\n\n// import java.util.regex.Pattern\n\n// // Function to process the answer string based on wordsOrPhrases\n// def processAnswer(String answer, List wordsOrPhrases) {\n//     def block = false\n//     def filteredAnswer = answer\n    \n//     wordsOrPhrases.each { wordOrPhrase ->\n//         def pattern = \"(?i)\" + Pattern.quote(wordOrPhrase.name)\n//         def newAnswer = filteredAnswer.replaceAll(pattern, \"\")\n//         if (newAnswer != filteredAnswer) {\n//             block = true\n//         }\n//         filteredAnswer = newAnswer\n//     }\n\n//     return [\"filtered_answer\": filteredAnswer, \"block\": block]\n// }\n\n// return processAnswer(answer, wordsOrPhrases)\n\nimport java.util.regex.Pattern\n\n// Function to process the answer string based on wordsOrPhrases\ndef processAnswer(String answer, List wordsOrPhrases) {\n    def block = false\n    def filteredAnswer = answer\n    \n    wordsOrPhrases.each { wordOrPhrase ->\n        def pattern = \"(?i)\" + Pattern.quote(wordOrPhrase.name)\n        def newAnswer = filteredAnswer.replaceAll(pattern, \"\").trim()\n        if (newAnswer != filteredAnswer) {\n            block = true\n        }\n        filteredAnswer = newAnswer\n    }\n\n    // Remove extra spaces\n    //filteredAnswer = filteredAnswer.replaceAll(\"\\\\s+\", \" \").trim()\n\n    return [\"filtered_answer\": filteredAnswer, \"block\": block]\n}\n\nreturn processAnswer(answer, wordsOrPhrases)",
				"isAsync":false,
				"parameters":{
					"wordsOrPhrases":{
						"source":"{{ ZaGfO.outputs.wordsOrPhrases }}",
						"ua:type":"mappedArray",
						"items":"{{ ZaGfO.outputs.wordsOrPhrases[0] }}"
					},
					"filterProfanity":"{{ ZaGfO.outputs.filterProfanity }}",
					"answer":"{{ ZaGfO.outputs.answer }}",
					"profanityList":{
						"source":"{{ 1LRFg.outputs.properties.profaneWords }}",
						"ua:type":"mappedArray",
						"items":"{{ 1LRFg.outputs.properties.profaneWords[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code By UnifyApps",
			"title":"Execute groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":300,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"CONTINUE",
			"groupId":"Dc7oH-1",
			"id":"b66uk",
			"index":9,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"timeTaken":{
							"type":"number",
							"title":"Time Taken"
						}
					},
					"additionalProperties":false,
					"required":[
						"timeTaken"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"caseId"
						},
						"messageId":{
							"type":"string",
							"title":"messageId"
						},
						"step":{
							"type":"string",
							"title":"step"
						},
						"parent":{
							"type":"string",
							"title":"parent"
						},
						"input":{
							"type":"object",
							"title":"input"
						},
						"output":{
							"type":"object",
							"title":"output"
						},
						"agentId":{
							"type":"string",
							"title":"Agent Id"
						},
						"startTime":{
							"type":"integer",
							"title":"Start Time"
						}
					},
					"additionalProperties":false,
					"required":[
						"agentId",
						"startTime"
					]
				},
				"compile_static":false,
				"code":"def timeTaken = System.currentTimeMillis() - startTime\nreturn ['timeTaken': timeTaken]\n",
				"parameters":{
					"step":"Custom Word Filter",
					"parent":"Guardrail",
					"startTime":"{{ t4nNA.outputs.result.now }}",
					"caseId":"{{ U3IHx.outputs.caseId }}",
					"messageId":"{{ U3IHx.outputs.messageId }}",
					"input":"{{ ZaGfO.outputs.answer }}",
					"output":"{{ d40Bw.outputs.result.filtered_answer }}",
					"agentId":"{{ U3IHx.outputs.aiAgentId }}"
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"CONTINUE",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Capture Trace",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.record.tools.items"
				]
			},
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":291,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"CONTINUE",
			"groupId":"Dc7oH-1",
			"id":"_CqcoE",
			"index":10,
			"inputs":{
				"writeThroughSessionVariables":false,
				"object_type":"e_traces",
				"skipIfBlank":false,
				"record":{
					"caseId":"{{ U3IHx.outputs.caseId }}",
					"aiAgentId":"{{ U3IHx.outputs.aiAgentId }}",
					"executionInstanceId":"{{ __RUN__.outputs.executionId }}",
					"parent":"Guardrail",
					"messageId":"{{ U3IHx.outputs.messageId }}",
					"llmTimeTaken":"{{ b66uk.outputs.result.timeTaken }}",
					"input":"{{ ZaGfO.outputs }}",
					"currentType":"Custom Word Filter",
					"rootExecutionId":"{{ __RUN__.outputs.rootExecutionId }}",
					"parentExecutionId":"{{ __RUN__.outputs.parentExecutionId }}",
					"userId":"=IF(ISNUMBER({{ __RUN__.outputs.userId }}), {{ __RUN__.outputs.userId }}, 0)",
					"output":"{{ d40Bw.outputs.result.filtered_answer }}",
					"fromAutomationId":"66b32227db0c6546b93d3acc",
					"startTime":"{{ t4nNA.outputs.result.now }}",
					"success":true
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"CONTINUE",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"Create Trace",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Dc7oH-1",
			"id":"KszV6",
			"index":11,
			"inputs":{
				"result":{
					"block":"{{ d40Bw.outputs.result.block }}",
					"filtered_answer":"{{ d40Bw.outputs.result.filtered_answer }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent"
	],
	"version":127
}